var PropertySearchPage={access_mode:null,search_type:null,LOCALITIES_IN_ROW:4,locality_list:null,apartment_community_list:null,HIDDEN_FIELD_POSTFIX:"_hidden",HIDDEN_FIELDS_CONTAINER:"hidden_fields_container",LOC_HIDDEN_FIELDS_HOLDER:"locality_hidden_fields_container",LOCATION_HIDDEN_FIELDS_HOLDER:"location_hidden_fields_container",COM_HIDDEN_FIELDS_HOLDER:"community_hidden_fields_container",popular_localities:null,isPopularLocalityCountRequired:false,isNearByLocalityCountRequired:false,isFetchResultsFromPopularLocalities:false,pageSize:24,prevReqForm:null,relevantResultPageSize:20,infScrollPageSize:10,locationsContainer:[],requestCnt:0,requestObj:{},projectSearchPageSize:3,filtersSetByUser:!1,reqParams:!1,lastPageReachedForProject:false,initialize:function(access_mode,search_type){this.access_mode=access_mode;this.search_type=search_type},handleCountTab:function(isMobile,tab_type,elem,page){page=page?" "+page:"";_gaq.push(["_trackEvent","Property Search Filter","SRP Faceted tab click",tab_type]);if(tab_type=="all"){jQuery("#physically_verified").val("0");jQuery("#has_image").val("0")}else{if(tab_type=="withImage"){jQuery("#physically_verified").val("0");jQuery("#has_image").val("1")}else{if(tab_type=="verified"){jQuery("#physically_verified").val("1");jQuery("#has_image").val("0")}}}jQuery(".result_count_div a").removeClass("activeTab");elem.addClassName("activeTab");this.fetchResults(1,"","",isMobile||0)},verifiedListing:function(isMobile,isVerified,page){var label=isVerified=="1"?"verified":"all";page=page?" "+page:"";_gaq.push(["_trackEvent","Verified","Top tab click"+page,label]);jQuery("#physically_verified").val(isVerified);jQuery("#has_image").val("0");this.fetchResults(1,"","",isMobile||0);jQuery("#search_results_count").toggleClass("active");jQuery("#verified_search_results_count").toggleClass("active")},listingHavingImage:function(isMobile,withImage,page){var label=withImage=="1"?"withImage":"all";page=page?" "+page:"";_gaq.push(["_trackEvent","With Image","Top tab click"+page,label]);jQuery("#has_image").val(withImage);jQuery("#physically_verified").val("0");this.fetchResults(1,"","",isMobile||0);jQuery("#search_results_count").toggleClass("active");jQuery("#with_image_search_results_count").toggleClass("active")},saveSearch:function(server_ip){var url=PropertySearchPage.getSaveSearchParams();_gaq.push(["_trackEvent","Buy rent tab","Save Search Results clicked",server_ip]);save_url=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+url;window.prompt("Save this Search: Ctrl+C, Enter",save_url)},getSaveSearchParams:function(){var save_url="";var url="";var city=$("city").value;var property_type=$("search_intent_hidden").value;if(property_type=="rent"){url+="search_intent=rent"}else{url+="search_intent=sale"}if(city){url+="&city="+encodeURIComponent(city)}var location_filter=$$('#property_listing_input_options #hidden_fields_container input[name="property_location_filter[]"]');if(location_filter.length>0){for(var i=0;i<location_filter.length;i++){url+="&property_location_filter[]="+location_filter[i].value}}var consider_nearby=$A(document.getElementsByName("consider_nearby_areas"));consider_nearby.each(function(opt){if(opt.checked){url+="&consider_nearby_areas=true"}});var bed_rooms=$A(document.getElementsByName("bed_rooms"));var bed_options=bed_rooms[0].options;var bhks=new Array();$A(bed_options).each(function(opt){if(opt.selected){bhks.push(opt.value)}});if(bhks.length){url+="&bed_rooms="+encodeURIComponent(bhks.join(","))}var bath_rooms=$A(document.getElementsByName("bath_rooms"));var bath_options=bath_rooms[0].options;var baths=new Array();$A(bath_options).each(function(opt){if(opt.selected){baths.push(opt.value)}});if(baths.length){url+="&bath_rooms="+encodeURIComponent(baths.join(","))}var min_inr=$("min_inr").value;if(min_inr){url+="&min_inr="+min_inr}var max_inr=$("max_inr").value;if(max_inr){url+="&max_inr="+max_inr}var house_types=$A(document.getElementsByName("house_type[]"));house_types.each(function(opt){if(opt.checked){url+="&house_type[]="+encodeURIComponent(opt.value)}});var furnish_state=$A(document.getElementsByName("furnish_state[]"));furnish_state.each(function(opt){if(opt.checked){url+="&furnish_state[]="+encodeURIComponent(opt.value)}});var posted_by=$A(document.getElementsByName("posted_by[]"));posted_by.each(function(opt){if(opt.checked){url+="&posted_by[]="+encodeURIComponent(opt.value)}});var listing_type=$("listings_type").value;if(listing_type=="property"){url+="&listings_type=property"}else{url+="&listings_type=requirement"}var min_builtup=$("builtup_min").value;if(min_builtup&&min_builtup!="Min"){url+="&builtup_area_min="+min_builtup}var max_builtup=$("builtup_max").value;if(max_builtup&&max_builtup!="Max"){url+="&builtup_area_max="+max_builtup}var two_wheeler_parking=$A(document.getElementsByName("two_wheeler_parking"));var two_wheeler_parking_options=two_wheeler_parking[0].options;var sel_two_wheeler_parking=new Array();$A(two_wheeler_parking_options).each(function(opt){if(opt.selected){sel_two_wheeler_parking.push(opt.value)}});if(sel_two_wheeler_parking.length){url+="&two_wheeler_parking="+encodeURIComponent(sel_two_wheeler_parking.join(","))}var four_wheeler_parking=$A(document.getElementsByName("four_wheeler_parking"));var four_wheeler_parking_options=four_wheeler_parking[0].options;var sel_four_wheeler_parking=new Array();$A(four_wheeler_parking_options).each(function(opt){if(opt.selected){sel_four_wheeler_parking.push(opt.value)}});if(sel_four_wheeler_parking.length){url+="&four_wheeler_parking="+encodeURIComponent(sel_four_wheeler_parking.join(","))}var amenities=$A(document.getElementsByName("amenities"));var amenities_options=amenities[0].options;var sel_amenities=new Array();$A(amenities_options).each(function(opt){if(opt.selected){sel_amenities.push(opt.value)}});if(sel_amenities.length){url+="&amenities="+encodeURIComponent(sel_amenities.join(","))}var ownership=$A(document.getElementsByName("ownership[]"));ownership.each(function(opt){if(opt.checked){url+="&ownership[]="+encodeURIComponent(opt.value)}});var servant_accommodation=$A(document.getElementsByName("servant_accommodation"));var servant_accommodation_options=servant_accommodation[0].options;var sel_servant_accommodation=new Array();$A(servant_accommodation_options).each(function(opt){if(opt.selected){sel_servant_accommodation.push(opt.value)}});if(sel_servant_accommodation.length){url+="&servant_accommodation="+encodeURIComponent(sel_servant_accommodation.join(","))}var direction_facing=$A(document.getElementsByName("direction_facing"));var direction_facing_options=direction_facing[0].options;var sel_direction_facing=new Array();$A(direction_facing_options).each(function(opt){if(opt.selected){sel_direction_facing.push(opt.value)}});if(sel_direction_facing.length){url+="&direction_facing="+encodeURIComponent(sel_direction_facing.join(","))}var sortBy=$("listings_sort_by").value;if(sortBy.length){url+="&srtby="+sortBy}var physicallyVerified=$("physically_verified").value;if(physicallyVerified.length){url+="&physically_verified="+physicallyVerified}var hasImage=$("has_image").value;if(hasImage.length){url+="&has_image="+hasImage}var flooring=$A(document.getElementsByName("flooring"));var flooring_options=flooring[0].options;var sel_flooring=new Array();$A(flooring_options).each(function(opt){if(opt.selected){sel_flooring.push(opt.value)}});if(sel_flooring.length){url+="&flooring="+encodeURIComponent(sel_flooring.join(","))}url+="&use_pp=0";return url},clearFetchedSuggestions:function(){if(1>=$("property_location_input").value.length){$("suggstr").value="";$("autosuggest").fire("autosuggest:reset")}},getXMLRequest:function(){try{var ro=new XMLHttpRequest()}catch(e){var ro=new ActiveXObject("Microsoft.XMLHTTP")}return ro},displayOptionsPopup:function(base_div,options_div){if($(options_div).visible()){$(options_div).hide();return}var offset_info=$(base_div).cumulativeOffset();offset_left=offset_info[0];offset_top=offset_info[1];$(options_div).style.top=(offset_top+20)+"px";$(options_div).style.left=(offset_left)+"px";$(options_div).show()},pickCity:function(city){$("city").value=city;$("selected_city").innerHTML=city;if($("nearby_areas_select_div")!=undefined){$("nearby_areas_select_div").show()}this.clearLocations();$("suggstr").value="";$("autosuggest").fire("autosuggest:reset");this.fetchAds(city);this.filterEventHandler()},fetchAds:function(city){if(typeof city==="undefined"){city="city="}else{city="city="+encodeURIComponent(city)}if($("featured_projects")!=null){$("featured_projects").update("");new Ajax.Request("/get-featured-projects-ads",{method:"POST",parameters:city,onSuccess:function(transport){var response=transport.responseText.evalJSON();if(response.status==1){$("featured_projects").update(response.value)}if(jQuery.cfitrack!==undefined){jQuery('.featured_projects div[cfi_entity_subtype="featured_project"]').cfitrack()}},onFailure:function(transport){}})}if($("header_banners_container")!=null){$("header_banners_container").update("");new Ajax.Request("/property-listing-public/get-property-search-banner-ads",{method:"GET",parameters:city,onSuccess:function(transport){var resultArray=transport.responseText.split("|");resultArray[0]=trim(resultArray[0].replace("/(\r\n|\n|\r)/gm",""));if(resultArray[0]=="1"){$("header_banners_container").update(resultArray[1])}if(jQuery.cfitrack!==undefined){jQuery(".ads_banner_img").cfitrack()}},onFailure:function(transport){alert("failure")}})}},clearLocalities:function(){$("picked_localities").innerHTML="";$(this.HIDDEN_FIELDS_CONTAINER).innerHTML="";this.clearCommunities()},clearLocations:function(){if($("picked_locations")!==null){$("picked_locations").innerHTML=""}if($(this.HIDDEN_FIELDS_CONTAINER)!==null){$(this.HIDDEN_FIELDS_CONTAINER).innerHTML=""}if($("property_location_input")!==null){$("property_location_input").value=""}},pickLocalities:function(){},fetchTopLocalities:function(location_type){var form_params;var extra_params="";if($(location_type+"_ul")!=undefined&&((location_type=="popular_loc"&&PropertySearchPage.isPopularLocalityCountRequired==true)||(location_type=="near_by"&&PropertySearchPage.isNearByLocalityCountRequired==true))){extra_params+="&is_count=true";var _localities=$(location_type+"_ul").childElements();for(var count=0;count<_localities.length;count++){var locality=_localities[count].id;var _id=locality.split("|");extra_params+="&location_ids_for_count[]="+_id[1];$(_id[1]+"_count").update()}if(location_type=="popular_loc"){for(var count=0;count<PropertySearchPage.popular_localities.length;count++){extra_params+="&location_ids_for_count[]="+PropertySearchPage.popular_localities[count].id}}}var isLoaderRequired;if(location_type=="near_by"){isLoaderRequired=!(PropertySearchPage.isNearByLocalityCountRequired==true)}else{isLoaderRequired=!(PropertySearchPage.isPopularLocalityCountRequired==true)}if(isLoaderRequired&&$("city").value!=""){var list_height=$(location_type).getHeight();$(location_type+"_main").addClassName("showingloadicon");$(location_type).hide()}else{if($("city").value==""){$(location_type).hide()}}if($("popular_loc_ul")!=undefined&&location_type=="near_by"&&PropertySearchPage.isNearByLocalityCountRequired==false){var _localities=$("popular_loc_ul").childElements();for(var count=0;count<_localities.length;count++){var locality=_localities[count].id;var _id=locality.split("|");extra_params+="&not_consider_areas[]="+_id[1]}}form_params=$("property_listing_input_options").serialize()+"&location_type="+encodeURIComponent(location_type)+extra_params;new Ajax.Request("/property-listing/get-locality-count",{method:"POST",parameters:form_params,onSuccess:function(transport){var results=eval("("+transport.responseText+")");var count_check=(location_type=="popular_loc")?(!PropertySearchPage.isPopularLocalityCountRequired==true||PropertySearchPage.isPopularLocalityCountRequired==-1):!PropertySearchPage.isNearByLocalityCountRequired;if(results!=null&&results.length>0&&count_check){var popular_localities;$(location_type).update();var ul=document.createElement("ul");ul.setAttribute("id",location_type+"_ul");var count=0;for(i=0;i<results.length&&count<5;i++){if($("popular_loc|"+results[i].id)==undefined){var li=PropertySearchPage.createPopularLocality(results[i],location_type);ul.appendChild(li);count++}}if(location_type=="popular_loc"){PropertySearchPage.popular_localities=results.splice(count,results.length);$("popular_loc_main").show()}$(location_type).appendChild(ul);$(location_type).show();$(location_type+"_main").show();$(location_type+"_main").removeClassName("showingloadicon");if($(location_type+"_span").hasClassName("plus")){$(location_type+"_span").setAttribute("class","minus")}}else{if((location_type=="popular_loc"&&PropertySearchPage.isPopularLocalityCountRequired==true)||(location_type=="near_by"&&PropertySearchPage.isNearByLocalityCountRequired==true)){var itemsToRemove=new Array();var updatedElements=new Array();var count=0;if(results!=null){for(i=0;i<results.length;i++){if($("popular_loc|"+results[i].id)!=undefined){$(results[i].id+"_count").update(" ["+results[i].count+"]");if(PropertySearchPage.isPopularLocalityCountRequired){itemsToRemove.push(i)}updatedElements.push("popular_loc|"+results[i].id);count++}}if(location_type=="popular_loc"){PropertySearchPage.popular_localities=results.splice(count,results.length)}}else{PropertySearchPage.popular_localities=[]}var _localities=$(location_type+"_ul").childElements();for(var count=0;count<_localities.length;count++){if(!PropertySearchPage.inArray(_localities[count].id,updatedElements)){var _id=_localities[count].id.split("|");$(_id[1]+"_count").update("[0]")}}if(PropertySearchPage.isPopularLocalityCountRequired==true&&results!=null){for(i=0;i<itemsToRemove.length;i++){results(itemsToRemove[i],1)}if(results.length>0&&location_type=="popular_loc"){PropertySearchPage.popular_localities=results}}}else{$(location_type+"_main").hide();$(location_type+"_main").removeClassName("showingloadicon")}}},onComplete:function(transport){if(location_type=="popular_loc"){}else{}}})},hidePopularLocalities:function(id,isHideOnly){if(isHideOnly==null){isHideOnly=false}if($(id+"_head")!=undefined){if(isHideOnly){$(id+"_span").setAttribute("class","plus");if($(id+"_ul")!=undefined){$(id+"_ul").hide()}return}if($(id+"_span").hasClassName("minus")){$(id+"_span").setAttribute("class","plus");if($(id+"_ul")!=undefined){$(id+"_ul").hide()}}else{$(id+"_span").setAttribute("class","minus");if($(id+"_ul")!=undefined){$(id+"_ul").show()}}}},handlePopularLocalities:function(clickedElement,isConsiderRegion){if(isConsiderRegion==1){isConsiderRegion=true}else{isConsiderRegion=false}var location_filter=document.getElementsByName("property_location_filter[]");var location_ids=[];var localities_to_replace=[];for(var count=0;count<location_filter.length;count++){var loc_id=location_filter[count].value.split("_");if(loc_id[0]!="apartment"){PropertySearchPage.locationsContainer.push(location_filter[count].value);location_ids.push(location_filter[count].value)}}if($("popular_loc_ul")!=null){var popular_localities=$("popular_loc_ul").childElements();for(var count=0;count<popular_localities.length;count++){var locality=popular_localities[count].id;_id=locality.split("|");PropertySearchPage.locationsContainer.push(_id[1]);if(popular_localities[count].getAttribute("parent_id")){PropertySearchPage.locationsContainer.push(popular_localities[count].getAttribute("parent_id"))}if(PropertySearchPage.inArray(_id[1],location_ids)||PropertySearchPage.inArray(popular_localities[count].getAttribute("parent_id"),location_ids)){localities_to_replace.push(locality)}}for(var count=0;count<PropertySearchPage.popular_localities.length;count++){if(PropertySearchPage.inArray(PropertySearchPage.popular_localities[count].id,PropertySearchPage.locationsContainer)||(isConsiderRegion==true&&PropertySearchPage.inArray(PropertySearchPage.popular_localities[count].parent_id,PropertySearchPage.locationsContainer))){PropertySearchPage.popular_localities.splice(count,1)}}var location_type="popular_loc";if(localities_to_replace.length>0&&PropertySearchPage.popular_localities.length>0){for(var count=0;count<localities_to_replace.length;count++){if(PropertySearchPage.popular_localities.length>0){var elementToAdd;for(var _count=0;count<PropertySearchPage.popular_localities.length;_count++){elementToAdd=PropertySearchPage.popular_localities[_count];PropertySearchPage.popular_localities.splice(_count,1);if($("popular_loc|"+elementToAdd.id)!=undefined){continue}else{break}}var liEle=PropertySearchPage.createPopularLocality(elementToAdd,location_type);liEle.hide();$("popular_loc_ul").appendChild(liEle);$(localities_to_replace[count]).fade({duration:1,from:1,to:0,afterFinish:function(){liEle.show();liEle.fade({duration:1.5,from:0,to:1})}});$(localities_to_replace[count]).remove();PropertySearchPage.isFetchResultsFromPopularLocalities=true}if(clickedElement!=undefined||clickedElement!=null){var tmp=PropertySearchPage.isPopularLocalityCountRequired;PropertySearchPage.isPopularLocalityCountRequired=-1;PropertySearchPage.fetchResults();PropertySearchPage.isPopularLocalityCountRequired=tmp}PropertySearchPage.locationsContainer=[]}}else{for(var count=0;count<localities_to_replace.length;count++){$(localities_to_replace[count]).fade({duration:1.5,from:1,to:0});$(localities_to_replace[count]).remove()}if(localities_to_replace.length>0){PropertySearchPage.isPopularLocalityCountRequired=-1;PropertySearchPage.fetchResults()}}}},createPopularLocality:function(elementToAdd,location_type){var liEle=document.createElement("li");var locality=document.createElement("span");var localityName=document.createElement("span");locality.addClassName("popular_locality_name");localityName.setAttribute("id","loc_"+elementToAdd.id);localityName.update(elementToAdd.name);locality.appendChild(localityName);var localityAddInfo=document.createElement("span");localityAddInfo.addClassName("popular_locality_add");localityAddInfo.update("<strong>+</strong> Add");liEle.setAttribute("id","popular_loc|"+elementToAdd.id);if(elementToAdd.parent_id!=null){liEle.setAttribute("parent_id",elementToAdd.parent_id)}liEle.appendChild(locality);liEle.appendChild(localityAddInfo);var listing_count=document.createElement("span");listing_count.setAttribute("name","popular_loc_count");listing_count.setAttribute("id",elementToAdd.id+"_count");listing_count.update(" ["+elementToAdd.count+"]");locality.appendChild(listing_count);liEle.onclick=function onclick(event){var spanId=this.id;var id=spanId.split("|");var localityName=$("loc_"+id[1]).innerHTML;var text="";cf_suggester.selectSuggestion(localityName,id[1]);if(location_type=="popular_loc"){var text="popular Localities";PropertySearchPage.prevReqForm=$("property_listing_input_options").serialize();PropertySearchPage.handlePopularLocalities(this)}else{var text="Nearby Localities";var tmp=PropertySearchPage.isPopularLocalityCountRequired;PropertySearchPage.isPopularLocalityCountRequired=-1;PropertySearchPage.fetchResults();PropertySearchPage.isPopularLocalityCountRequired=tmp}_gaq.push(["_trackEvent","suggested areas",text,localityName,1]);$("nearby_areas_select_div").show()};return liEle},fetchResults:function(page,eventObj,infScroll,isMobile){if(($("requirement_request")!=undefined&&$("requirement_request").value==1)){$("listing_loader").hide();return}if($("project_summary")!==null&&!infScroll){Effect.BlindUp("project_summary",{duration:1})}if(undefined!=$("mediationflashmsg")){$("mediationflashmsg").hide()}if(page==undefined){page=1}if(infScroll==undefined){infScroll=false}if(isMobile==undefined){isMobile=0}if(!infScroll){reqNo=++this.requestCnt}else{reqNo=-1}var lastpage=page;var pageSize=this.pageSize;var url="";var search_intent_value="";var sortBy="";search_intent=document.property_listing_input_options.search_intent;if(typeof eventObj!="undefined"&&eventObj){if(eventObj.id=="search_intent_rent"||eventObj.id=="search_intent_sale"){PropertySearchPage.clearPrices(false)}}if($("search_intent_hidden").value=="rent"){search_intent_value=$("search_intent_hidden").value;$("price_filter_heading").innerHTML="Budget:";var newSpan=document.createElement("span");newSpan.className="excl-maintenance";newSpan.innerHTML="(Excluding Maintenance)";$("price_filter_heading").appendChild(newSpan)}else{search_intent_value=$("search_intent_hidden").value;$("price_filter_heading").innerHTML="Budget:"}var curr_breadcrumb=$("current_breadcrumb");if(this.access_mode=="public"){if(search_intent_value=="rent"){url+="/property-listing/get-listing-results"}else{url+="/property-listing/get-listing-results"}if(this.detectHistorySupport()&&curr_breadcrumb!=undefined){}}else{if(this.access_mode=="private"){url+="/property-listing/show-property-listings"}else{$("listing_loader").hide();return}}if($("listings_type")!=null&&$("listings_type").value=="property"){if(infScroll==false&&!isMobile){$("listing_loader").hide();this.fetchProjects()}if($("post_requirement_form")!=undefined){$("post_requirement_form").show()}if($("post_req_msg")!=undefined){$("post_req_msg").show()}try{$("listings_type_hidden").value=$("listings_type").value;$("listings_type_prop_input_div").className="listings_type_selected";$("listings_type_req_input_div").className="listings_type_unselected";if($("listings_sort_by_container")){$("listings_sort_by_container").show();sortBy=$("listings_sort_by").value;$$(".listing_tool_bar").first().show();$$(".listing_tool_bar_box").first().hide()}}catch(e){}}else{if(infScroll==false&&$("project-bar")!=null){$("project-bar").hide()}if($("post_requirement_form")!=undefined){$("post_requirement_form").hide()}if($("post_req_msg")!=undefined){$("post_req_msg").hide()}try{$("listings_type_hidden").value=$("listings_type").value;$("listings_type_prop_input_div").className="listings_type_unselected";$("listings_type_req_input_div").className="listings_type_selected";if($("listings_sort_by_container")){$("listings_sort_by_container").hide();$$(".listing_tool_bar").first().hide();$$(".listing_tool_bar_box").first().show()}}catch(e){}}if(!infScroll){$("listing_loader").show()}else{if(page!=1){page+=(pageSize-this.infScrollPageSize)/this.infScrollPageSize;pageSize=this.infScrollPageSize}}var show_hidden_count=false;if($("pagination_type")!=undefined&&$("pagination_type").value!="infinite"){show_hidden_count=true}if(typeof(newMessageObj)!="undefined"){newMessageObj.close()}if(reqNo!=-1){for(v in this.requestObj){if(!Prototype.Browser.IE&&this.requestObj[v].transport){try{this.requestObj[v].transport.aborted=true;this.requestObj[v].transport.abort()}catch(e){}}delete this.requestObj[v]}}var conditional="&def_filters=1";if(this.filtersSetByUser){conditional=""}if(infScroll&&this.reqParams){for(var k in this.reqParams){conditional+="&"+k+"="+this.reqParams[k]}}if(isMobile){form_parameter=jQuery("#property_listing_input_options").serialize()}else{form_parameter=$("property_listing_input_options").serialize()}var ajaxRequest=new Ajax.Request(url,{method:"POST",parameters:form_parameter+"&page="+page+"&r=a&srtby="+sortBy+"&page_size="+pageSize+"&show_hidden_count="+show_hidden_count+"&req="+reqNo+conditional,onSuccess:function(transport){var splitter=transport.responseText.indexOf("#!#");var currReqNo=0;if(splitter==-1){currReqNo=-1;splitter=0}else{currReqNo=transport.responseText.substr(0,splitter);splitter+=3}transport.responseText=transport.responseText.substr(splitter);if(infScroll){var nextPage=document.createElement("div");nextPage.innerHTML+=transport.responseText;jQuery(".pad5.floatRight").remove();jQuery(nextPage).find(".pad5.floatRight").remove();$("results_div").appendChild(nextPage);if(typeof jQuery.cfitrack!=="undefined"){jQuery(nextPage).find(".listing_snippet").cfitrack({commonDataElement:jQuery("#cfi_listing_common_data")})}$("results_div").fire("inf:pageSuccess");PropertySearchPage.evalScript(nextPage);if(!isMobile){initiateFlexsliderAfterAjaxCall()}var re_list=$$("#results_div .listing_snippet"),re_page_break=$$("#results_div .page_hr");if(re_list.length&&re_list.length>24){var offs=24+(re_page_break.length*pageSize),left_over=(re_list.length-offs);if(left_over>0){if(isMobile){var before_data=""}else{var num2=re_list.length;if($("sponsored_listing_id").value){offs++}var before_data="<div class='page_hr' style='color:#4D4D4D'><hr/><div>Showing results:  <span class='showing_result'> "+(offs+1)+"-<span class='_to'>"+num2+"</span></span></div><hr/></div>"}re_list[offs].previous().insert({before:before_data});if(re_page_break.length){var prev_pb=re_page_break.last().down("span._to");if(prev_pb.innerHTML!=offs){prev_pb.update(offs)}}}}}else{if(currReqNo==PropertySearchPage.requestCnt){if(typeof jQuery.cfitrack!=="undefined"){jQuery("#results_div .listing_snippet").cfitrack("destroy")}$("listing_loader").hide();jQuery(".pad5.floatRight").remove();$("results_div").fire("inf:stop");$("results_div").innerHTML=transport.responseText;if(typeof jQuery.cfitrack!=="undefined"){jQuery("#results_div .listing_snippet").cfitrack({commonDataElement:jQuery("#cfi_listing_common_data")})}if($("search_results_last_page").value>1&&show_hidden_count==false){$("search_results_last_page").value=1+Math.ceil((parseInt($("search_results_count_hidden").value)-pageSize)/PropertySearchPage.infScrollPageSize)}PropertySearchPage.evalScript($("results_div"));PropertySearchPage.bindMinimize();if(!isMobile){reorderPaginationPanel(lastpage);initiateFlexsliderAfterAjaxCall()}$("results_div").fire("inf:reset");$("results_div").fire("inf:start");if(typeof PropertySearchPage.reqParams.last_page!="undefined"){InfiniteContent.reachedLastPage()}if(jQuery("#search_count_excluding_phy_verified_filter_hidden").length==0){if($("search_results_count_hidden").value&&$("listings_type").value=="property"){$("search_results_count").innerHTML=$("search_results_count_hidden").value+"<span> Results </span>"}else{$("search_results_count").innerHTML=""}}else{if($("search_count_excluding_phy_verified_filter_hidden").value&&$("listings_type").value=="property"){$("search_results_count").innerHTML="All ("+$("search_count_excluding_phy_verified_filter_hidden").value+")";if($("verified_search_results_count_hidden").value!="0"){jQuery(".result_count_div .validated_link").show()}if($("with_image_search_results_count_hidden").value!="0"){jQuery(".result_count_div .photo_link").show()}}else{$("search_results_count").innerHTML=""}if($("verified_search_results_count_hidden").value&&($("verified_search_results_count_hidden").value!="0"||$("physically_verified").value=="1")&&$("listings_type").value=="property"){$("verified_search_results_count").innerHTML=" CF - Verified ("+$("verified_search_results_count_hidden").value+")";jQuery(".result_count_div .validated_link").show()}else{$("verified_search_results_count").innerHTML="";jQuery(".result_count_div .validated_link").hide()}if($("with_image_search_results_count_hidden").value&&($("with_image_search_results_count_hidden").value!="0"||$("has_image").value=="1")&&$("listings_type").value=="property"){$("with_image_search_results_count").innerHTML="  With Photos ("+$("with_image_search_results_count_hidden").value+")";jQuery(".result_count_div .photo_link").show()}else{$("with_image_search_results_count").innerHTML="";jQuery(".result_count_div .photo_link").hide()}}}if(currReqNo!=-1){delete this.requestObj[currReqNo]}}},onFailure:function(transport){alert("Could not connect to CommonFloor Server for this request");$("results_div").fire("inf:pageFaliure")},onComplete:function(transport){if(!isMobile){initiateFlexsliderAfterAjaxCall()}if($("results_div1")!=undefined&&$("listings_type").value=="property"&&((InfiniteContent&&InfiniteContent.state==-1)||($("search_results_last_page").value==lastpage)||(!infScroll&&$("search_results_count_hidden").value<=PropertySearchPage.pageSize))){if(((!infScroll&&$$("#results_div .listing_snippet").length>=$("search_results_count_hidden").value)||infScroll)&&($("trk_caller").value!="broker-profile-page")){$("other_iscroll").show();PropertySearchPage.fetchExtraResults(undefined,undefined,undefined,isMobile)}}else{$("results_div1").update();$("other_iscroll").hide();$("close_results").hide();$("other_search_results_count").innerHTML=""}}});if(reqNo!=-1){this.requestObj[reqNo]=ajaxRequest}if(page==1&&!infScroll&&!isMobile){var property_element_ids=document.getElementsByName("property_name_filter[]");var locality_element_ids=document.getElementsByName("property_area_filter[]");var location_element_ids=document.getElementsByName("property_location_filter[]");var property_ids=new Array();for(var i=0;i<property_element_ids.length;i++){property_ids.push(property_element_ids[i].value)}var locality_ids=new Array();for(var i=0;i<locality_element_ids.length;i++){locality_ids.push(locality_element_ids[i].value)}var location_ids=new Array();for(var i=0;i<location_element_ids.length;i++){location_ids.push(location_element_ids[i].value)}if($("trk_caller").value!="broker-profile-page"){var city=$("city").value;PropertySearchPage.getSuggestedBrokers(city,location_ids,property_ids,search_intent_value)}var isLocationIdsSelected=false;if($("listings_type").value=="property"){if(location_element_ids.length>0){var isLocationIdsSelected=true}var popularLocalitiesRefresh=new Array("city","search_intent_hidden");if(houseTypeIds!=undefined){popularLocalitiesRefresh=popularLocalitiesRefresh.concat(houseTypeIds)}if((eventObj!=undefined&&PropertySearchPage.inArray(eventObj.id,popularLocalitiesRefresh)&&PropertySearchPage.isPopularLocalityCountRequired!=-1)||(PropertySearchPage.isPopularLocalityCountRequired==-10)){PropertySearchPage.isPopularLocalityCountRequired=false;PropertySearchPage.isNearByLocalityCountRequired=false;PropertySearchPage.fetchTopLocalities("popular_loc");if(PropertySearchPage.inArray("city",popularLocalitiesRefresh)){isLocationIdsSelected=true}}else{if(eventObj!=undefined&&eventObj.id=="consider_nearby_areas"){PropertySearchPage.isNearByLocalityCountRequired=false}else{if(PropertySearchPage.isPopularLocalityCountRequired!=-1&&PropertySearchPage.isPopularLocalityCountRequired!=-10){PropertySearchPage.isPopularLocalityCountRequired=true;if(PropertySearchPage.isNearByLocalityCountRequired==-1){PropertySearchPage.isNearByLocalityCountRequired=false}else{PropertySearchPage.isNearByLocalityCountRequired=true}if($("popular_loc_ul")==null){PropertySearchPage.isPopularLocalityCountRequired=false}if($("near_by_ul")==null){PropertySearchPage.isNearByLocalityCountRequired=false}PropertySearchPage.fetchTopLocalities("popular_loc")}}}if(PropertySearchPage.isPopularLocalityCountRequired==-10||PropertySearchPage.isNearByLocalityCountRequired==-10){PropertySearchPage.isPopularLocalityCountRequired=false;PropertySearchPage.isNearByLocalityCountRequired=false;PropertySearchPage.fetchTopLocalities("popular_loc");$("popular_loc_main").show()}if(PropertySearchPage.isPopularLocalityCountRequired==-1){PropertySearchPage.isNearByLocalityCountRequired=false;PropertySearchPage.isPopularLocalityCountRequired=true}if(isLocationIdsSelected==true){PropertySearchPage.fetchTopLocalities("near_by")}else{$("near_by_main").hide()}}else{$("near_by_main").hide();$("popular_loc_main").hide()}}},inArray:function(needle,haystack){for(var i=0,l=haystack.length;i<l;i++){if(haystack[i]==needle){return true}}return false},evalScript:function(div){var x=div.getElementsByTagName("script");var scriptBlocks=[];for(var i=0;i<x.length;i++){var oScript=document.createElement("script");oScript.text=x[i].text;scriptBlocks[i]=oScript}for(var i=0;i<scriptBlocks.length;i++){try{div.appendChild(scriptBlocks[i])}catch(e){continue}}},getSuggestedBrokers:function(city,location,property_id,intent){if((city!=undefined&&city!="")&&(intent!=undefined&&intent!="")){new Ajax.Request("/get-suggested-brokers",{method:"GET",parameters:"city="+encodeURIComponent(city)+"&scope="+encodeURIComponent(location)+"&property="+encodeURIComponent(property_id)+"&intent="+intent,onSuccess:function(transport){var results=eval("("+transport.responseText+")");if(results.status==1&&results.result.length>0){var builder_suggest_html="";$("suggested_brokers").innerHTML="";var builder_suggest_html_more="";var results_arr=results.result;builder_suggest_html+="<div class='suggested_heading'>Suggested Property Dealers</div>";var label;var profileLink;var isMoreBrokerDetails=false;for(var i=0;i<results_arr.length;i++){profileLink=results_arr[i]["profile_link"];label=results_arr[i]["display_label_content"];if(i<=1){if(label&&label!=""){builder_suggest_html+="<div class='suggested_broker_details'><a href='"+profileLink+"' target='_blank'onclick=\"_gaq.push(['_trackEvent', 'Property search Featured Dealer', 'Click on agent name', '"+results_arr[i]["name"]+" : "+city+"'])\">"+label+"</a></div>"}else{builder_suggest_html+="<div class='suggested_broker_details'><a href='"+profileLink+"' target='_blank'onclick=\"_gaq.push(['_trackEvent', 'Property search Featured Dealer', 'Click on agent name', '"+results_arr[i]["name"]+" : "+city+"'])\"><span><strong>"+results_arr[i]["company_name"]+"</strong>, Call <strong>"+results_arr[i]["name"]+"</strong> at "+results_arr[i]["contact_mobile"]+"</span></a></div>"}}else{isMoreBrokerDetails=true;if(label&&label!=""){builder_suggest_html_more+="<div class='suggested_broker_details'><a href='"+profileLink+"' target='_blank'>"+label+"</a></div>"}else{builder_suggest_html_more+="<div class='suggested_broker_details'><a href='"+profileLink+"' target='_blank'><span><strong>"+results_arr[i]["company_name"]+"</strong>, Call <strong>"+results_arr[i]["name"]+"</strong> at "+results_arr[i]["contact_mobile"]+"</span></a></div>"}}}if(isMoreBrokerDetails){builder_suggest_html+="<div id='broker_show_more' onclick=\"PropertySearchPage.handleBrokerShowMore(this);_gaq.push(['_trackEvent', 'Property search Featured Dealer', 'Click on show more', '"+city+"']);\"> Show more</div>";builder_suggest_html+="<div id='broker_more_details' style='display:none' >"+builder_suggest_html_more+"<div onclick=\"PropertySearchPage.handleBrokerShowMore(this);_gaq.push(['_trackEvent', 'Property search Featured Dealer', 'Click on show less', '"+city+"']);\" id='broker_show_less' style='display:none'>Show Less</div></div>"}$("suggested_brokers").innerHTML=builder_suggest_html;$("suggested_brokers").show();$("suggested_brokers_box").show()}else{$("suggested_brokers").innerHTML="";$("suggested_brokers").hide();$("suggested_brokers_box").hide()}}})}},handleBrokerShowMore:function(clickedElement){var id=clickedElement.id;if(id=="broker_show_more"){$(id).hide();$("broker_show_less").show();$("broker_more_details").show()}else{$("broker_more_details").hide();$(id).hide();$("broker_show_more").show()}},handleSearchIntent:function(clickedElement){var id=clickedElement.id;if(id=="search_intent_sale"){PropertySearchPage.handleSaleType("sale");$("search_intent_hidden").value="sale";handleBudgetValues("sale");PropertySearchPage.filterEventHandler(1,$("search_intent_hidden"))}else{if(id=="search_intent_rent"){PropertySearchPage.handleSaleType("rent");$("search_intent_hidden").value="rent";handleBudgetValues("rent");PropertySearchPage.filterEventHandler(1,$("search_intent_hidden"))}}},selectLocality:function(locality_name,check_box_id){var containerDiv=document.createElement("div");var localityNameSpan=document.createElement("span");localityNameSpan.innerHTML=locality_name;localityNameSpan.style.paddingLeft="1px";var localityDeselectLinkSpan=document.createElement("span");var deselectLink=document.createElement("a");deselectLink.innerHTML="[x]";deselectLink.setAttribute("href","javascript:void(0)");deselectLink.onclick=function onclick(event){PropertySearchPage.deselectLocality(locality_name,check_box_id)};localityDeselectLinkSpan.appendChild(deselectLink);containerDiv.appendChild(localityDeselectLinkSpan);containerDiv.appendChild(localityNameSpan);containerDiv.setAttribute("id","span_"+check_box_id);$("picked_localities").appendChild(containerDiv);this.addFormHiddenField(this.HIDDEN_FIELDS_CONTAINER,check_box_id,"property_area_filter[]",locality_name);$("property_area_input").value="";this.filterEventHandler()},selectNearbyAreas:function(locality_name,check_box_id){var containerDiv=document.createElement("div");var localityNameSpan=document.createElement("span");localityNameSpan.innerHTML=locality_name;var localityDeselectLinkSpan=document.createElement("span");var deselectLink=document.createElement("a");deselectLink.innerHTML="[x]";deselectLink.setAttribute("href","javascript:void(0)");deselectLink.onclick=function onclick(event){PropertySearchPage.deselectLocality(locality_name,check_box_id)};localityDeselectLinkSpan.appendChild(deselectLink);containerDiv.appendChild(localityDeselectLinkSpan);containerDiv.appendChild(localityNameSpan);containerDiv.setAttribute("id","span_"+check_box_id);$("picked_localities").appendChild(containerDiv);this.addFormHiddenField(this.HIDDEN_FIELDS_CONTAINER,check_box_id,"property_area_filter[]",locality_name);$("nearby_areas").value="";this.filterEventHandler()},clickLocalityCheckbox:function(object){check_box_id=object.id;locality_name=$(check_box_id+"_label").innerHTML;($(check_box_id).checked==true)?this.selectLocality(locality_name,check_box_id):this.deselectLocality(locality_name,check_box_id)},deselectLocality:function(locality_name,check_box_id){$("picked_localities").removeChild($("span_"+check_box_id));this.removeHiddenField(this.HIDDEN_FIELDS_CONTAINER,check_box_id);this.filterEventHandler()},selectLocation:function(location_name,check_box_id){if($("span_"+check_box_id)==null){var containerDiv=$(document.createElement("div"));containerDiv.addClassName("slocation");var localityNameSpan=$(document.createElement("span"));localityNameSpan.innerHTML="<span>"+location_name+"</span>&nbsp;";localityNameSpan.addClassName("slocationname");var deselectLink=document.createElement("input");deselectLink.setAttribute("type","button");deselectLink.setAttribute("value","X");deselectLink.addClassName("f10");deselectLink.onclick=function onclick(event){PropertySearchPage.deselectLocation(location_name,check_box_id)};localityNameSpan.appendChild(deselectLink);containerDiv.appendChild(localityNameSpan);containerDiv.setAttribute("id","span_"+check_box_id);$("picked_locations").appendChild(containerDiv);this.addFormHiddenField(this.HIDDEN_FIELDS_CONTAINER,check_box_id,"property_location_filter[]",check_box_id);$("property_location_input").value="";this.filterEventHandler()}},deselectLocation:function(location_name,check_box_id){$("picked_locations").removeChild($("span_"+check_box_id));this.removeHiddenField(this.HIDDEN_FIELDS_CONTAINER,check_box_id);this.filterEventHandler()},selectCommunity:function(community_name,check_box_id){var containerDiv=document.createElement("div");var communityNameSpan=document.createElement("span");communityNameSpan.innerHTML=community_name;communityNameSpan.style.paddingLeft="4px";var communityDeselectLinkSpan=document.createElement("span");var deselectLink=document.createElement("a");deselectLink.innerHTML="[x]";deselectLink.setAttribute("href","javascript:void(0)");deselectLink.onclick=function onclick(event){PropertySearchPage.deselectCommunity(community_name,check_box_id)};communityDeselectLinkSpan.appendChild(deselectLink);containerDiv.appendChild(communityDeselectLinkSpan);containerDiv.appendChild(communityNameSpan);containerDiv.setAttribute("id","span_"+check_box_id);$("picked_communities").appendChild(containerDiv);this.addFormHiddenField(this.COM_HIDDEN_FIELDS_HOLDER,check_box_id,"property_name_filter[]",check_box_id);$("property_apartment_input").value="";this.filterEventHandler()},clickCommunityCheckbox:function(object){var check_box_id=object.id;var community_name=$(check_box_id+"_label").innerHTML;($(check_box_id).checked==true)?this.selectCommunity(community_name,check_box_id):this.deselectCommunity(community_name,check_box_id)},deselectCommunity:function(community_name,check_box_id){$("picked_communities").removeChild($("span_"+check_box_id));this.removeHiddenField(this.COM_HIDDEN_FIELDS_HOLDER,check_box_id);this.filterEventHandler()},clearCommunities:function(){$("picked_communities").innerHTML="";$(this.COM_HIDDEN_FIELDS_HOLDER).innerHTML=""},getApartmentCommunityList:function(){var url="";if(this.access_mode=="public"){url+="/get-apartments-names-for-property-listing"}else{if(this.access_mode=="private"){url+="/property-listing/get-property-names"}}this.clearCommunities();new Ajax.Request(url,{method:"POST",parameters:$("property_listing_input_options").serialize(),onSuccess:function(transport){PropertySearchPage.apartment_community_list=eval("("+transport.responseText+")");PropertySearchPage.loadApartmentCommunityList()},onFailure:function(transport){alert("Could not connect to CommonFloor Server for this request")}})},loadApartmentCommunityList:function(){var divToModify=$("property_select");var newCommunities=$("properties_of_picked_areas");newCommunities.innerHTML="";var locationsContainer=new Element("div",{id:"areas_container"});locationsContainer.setStyle({height:"200px",overflow:"auto"});$("property_select").setStyle({width:"220px"});for(var i=0;i<this.apartment_community_list.length;i++){var community_info=this.apartment_community_list[i];if(community_info!=null){var tempDiv=new Element("div",{id:"property_name_filter_"+i+"_wraper"});var tempCheckbox=document.createElement("input");var tempCheckboxID="property_name_filter_"+i;tempCheckbox.setAttribute("id",tempCheckboxID);tempCheckbox.setAttribute("name",tempCheckboxID);tempCheckbox.setAttribute("pid",community_info[1]);tempCheckbox.setAttribute("type","checkbox");tempCheckbox.onclick=function onclick(event){var e=event||window.event;var target=e.target||e.srcElement;PropertySearchPage.clickCommunityCheckbox(target)};var communityName=document.createElement("span");communityName.setAttribute("id",tempCheckboxID+"_label");communityName.innerHTML=community_info[0];tempDiv.appendChild(tempCheckbox);tempDiv.appendChild(communityName);locationsContainer.appendChild(tempDiv);if(this.DEFAULT_COMMUNITY&&this.DEFAULT_COMMUNITY==community_info[1]){this.DEFAULT_COMMUNITY_CHECKBOX_ID=tempCheckboxID}}}newCommunities.appendChild(locationsContainer);var okButton=document.createElement("input");okButton.setAttribute("type","button");okButton.setAttribute("name","property_select_button");okButton.setAttribute("value","Done");okButton.onclick=function onclick(event){$("property_select").hide();PropertySearchPage.fetchResults()};newCommunities.appendChild(okButton);divToModify.appendChild(newCommunities);divToModify.appendChild(newCommunities)},keyPress:function(event,item,boxId,hiddenFieldId,callBackFunctionNames,inputValueId,subItem,fixedPosition){this.callBackFunctionNames=callBackFunctionNames;this.hiddenFieldId=hiddenFieldId;this.inputValueId=inputValueId;var city="";if((inputValueId!=undefined)&&inputValueId){city=$(inputValueId).value}else{city=$("city").value}if(city=="0"){alert("Please select a city");return}this.boxId=boxId;this.item=item;this.subItem=subItem;if(event){event=event}else{event=window.event}if(event.which){var keycode=event.which}else{var keycode=event.keyCode}if(keycode==13){}else{var charPress=String.fromCharCode(keycode);if(charPress){if(charPress.match(/^[a-zA-Z0-9_\-\b\s]$/)){if(typeof fixedPosition!="undefined"&&fixedPosition){setTimeout("PropertySearchPage.fetchList(true)",500)}else{setTimeout("PropertySearchPage.fetchList()",500)}}}}},fetchList:function(fixedPosition){var city="";if((this.inputValueId!=undefined)&&this.inputValueId){city=$(this.inputValueId).value}else{city=$("city").value}var pretext=$(this.boxId).value;var lasstEnteredtext="";if($("suggstr")!=undefined){lasstEnteredtext=$("suggstr").value}var boxId=this.boxId;var hiddenFieldId=this.hiddenFieldId;var callBackFunctionNames=this.callBackFunctionNames;if(city==""){if(((pretext.length-1)%2)==0){alert("Please select a City")}return}if((pretext.length<1)||(pretext==lasstEnteredtext)){return}if($("suggstr")!=undefined){$("suggstr").value=pretext}if(true){var req=PropertySearchPage.getXMLRequest();var params="";var nameWithSubItems=false;params+="item="+encodeURIComponent(this.item)+"&c="+encodeURIComponent(city)+"&str="+encodeURIComponent(pretext);if(this.subItem){params+="&sub_item="+encodeURIComponent(this.subItem);nameWithSubItems=true}if(pretext.length>2){req.open("GET","/autosuggest.php?"+params,true)}if(pretext.length>2){}req.setRequestHeader("X-Requested-With","XMLHttpRequest");req.onreadystatechange=function(){if(req.readyState==4){if(req.status==200){results=eval(req.responseText);if(results!=""){var cf_suggester=new AutoSuggest($(boxId),results);cf_suggester.setKeyEventHandlers();cf_suggester.hasPipe=true;cf_suggester.hiddenValueElementId=hiddenFieldId;if(callBackFunctionNames){cf_suggester.callBack=true;cf_suggester.callBackFunctionNames=callBackFunctionNames}if(nameWithSubItems){cf_suggester.nameWithSubItems=true}if(typeof fixedPosition!="undefined"&&fixedPosition){cf_suggester.processAutoSuggest(true)}else{cf_suggester.processAutoSuggest()}}else{}}else{alert("Could not find suggestions.")}}};req.send(null)}},verifyInteger:function(obj){var txt=parseInt(obj.value,10);if(isNaN(txt)){alert("Please enter a valid value. It should be an integer.");return false}else{return true}},isInteger:function(txt){if(!txt){return false}txt=parseInt(txt,10);if(isNaN(txt)){return false}else{return true}},handleAreaSelect:function(area){$("property_area_filter").value=area;$("selected_area").innerHTML=area;$("change").value="area";this.filterEventHandler()},handleMinInr:function(){minInrDiv=$("min_option_input_div");maxInrDiv=$("max_option_input_div");minInrDiv.style.display="none";maxInrDiv.style.display="none";minInrObj=$("min_inr");var isInt=this.verifyInteger(minInrObj);if(isInt==true){var maxInr=$("max_inr").value;var minInr=$("min_inr").value;if(this.isInteger(maxInr)==true){if(parseInt(minInr,10)>parseInt(maxInr,10)){minInrObj.value="";alert("Min value is greater than the Max value. Please enter a valid Min value");return}}$("clear_prices_link").show();this.filterEventHandler()}},handleMaxInr:function(){maxInrDiv=$("max_option_input_div");minInrDiv=$("min_option_input_div");minInrDiv.style.display="none";maxInrDiv.style.display="none";maxInrObj=$("max_inr");var isInt=this.verifyInteger(maxInrObj);if(isInt==true){var minInr=$("min_inr").value;var maxInr=$("max_inr").value;if(this.isInteger(minInr)==true){if(parseInt(minInr,10)>parseInt(maxInr,10)){maxInrObj.value="";alert("Max value is less than the Min value. Please enter a valid Max value");return}}$("clear_prices_link").show();this.filterEventHandler()}},handleMixMax:function(minElem,maxElem,evt){minElem=$(minElem);maxElem=$(maxElem);if(parseInt(minElem.value)>parseInt(maxElem.value)){if(evt.id===minElem.id){alert("Minimum must be lesser than maximim!");minElem.value="Min";return}else{alert("Maximim must be greater than minimum!");maxElem.value="Max";return}}this.filterEventHandler(1)},isNumberKey:function(evt){var charCode=(evt.which)?evt.which:evt.keyCode;if(charCode==37||charCode==39||charCode==46){return true}if(charCode>31&&(charCode<48||charCode>57)){return false}return true},calculateAmount:function(id){var crores=$("crores_"+id).value;var lakhs=$("lakhs_"+id).value;var thousands=$("thousands_"+id).value;var hundreds=$("hundreds_"+id).value;var inr=(10000000*crores)+(100000*lakhs)+(1000*thousands)+(100*hundreds);$(id).value=inr},getLocations:function(city){var url="";if(this.access_mode=="public"){url+="/get-locations-for-property-listing"}else{if(this.access_mode=="private"){url+="/property-listing/get-locations"}}new Ajax.Request(url,{method:"GET",parameters:"city="+encodeURIComponent(city)+"&type="+encodeURIComponent(PropertySearchPage.search_type),onSuccess:function(transport){PropertySearchPage.locality_list=eval(transport.responseText);PropertySearchPage.loadLocationsForInput()},onFailure:function(transport){alert("Could not connect to CommonFloor Server for this request")}})},loadLocationsForInput:function(){var divToModify=$("areas_select");var newAreas=$("areas_of_a_city");newAreas.innerHTML="";if(this.locality_list.length>0){$("areas_select").setStyle({width:220+"px"})}else{return}var areasContainer=new Element("div",{id:"areas_container"});areasContainer.setStyle({height:"200px",overflow:"auto"});var locationDataForAutoSuggest=new Array();for(var i=0;i<this.locality_list.length;i++){var str=this.locality_list[i];if(str!=""){var tempDiv=new Element("div",{id:"property_area_filter_"+i+"_wraper"});var tempCheckbox=document.createElement("input");var j=i;var tempCheckboxID="property_area_filter_"+j;tempCheckbox.setAttribute("id",tempCheckboxID);tempCheckbox.setAttribute("name",tempCheckboxID);tempCheckbox.setAttribute("value",str);tempCheckbox.setAttribute("type","checkbox");tempCheckbox.onclick=function onclick(event){var e=event||window.event;var target=e.target||e.srcElement;PropertySearchPage.clickLocalityCheckbox(target)};locationDataForAutoSuggest[j]=str+"|"+tempCheckboxID;var areaName=document.createElement("span");areaName.setAttribute("id","property_area_filter_"+i+"_label");areaName.innerHTML=str;tempDiv.appendChild(tempCheckbox);tempDiv.appendChild(areaName);areasContainer.appendChild(tempDiv)}}newAreas.appendChild(areasContainer);var okButton=document.createElement("input");okButton.setAttribute("type","button");okButton.setAttribute("name","area_select_button");okButton.setAttribute("value","Done");okButton.onclick=function onclick(event){$("areas_select").hide();PropertySearchPage.fetchResults()};newAreas.appendChild(okButton);divToModify.appendChild(newAreas)},useLocation:function(location,checkboxId){if($(checkboxId)){if($(checkboxId).checked==false){$(checkboxId).checked=true;PropertySearchPage.clickLocalityCheckbox($(checkboxId))}else{return}}},handleListingDetails:function(id){var detailsDivLinkHtml=$("listing_details_"+id).innerHTML;var trimmed=detailsDivLinkHtml.replace(/^\s+|\s+$/g,"");if(trimmed=="Show Details"){$("listing_details_"+id).innerHTML=" Hide Details ";$(id+"_details").show()}else{$("listing_details_"+id).innerHTML=" Show Details ";$(id+"_details").hide()}},slideImages:function(currentImageIndex,totalImagesCount,listingId,images_src_json_str){var json_str=images_src_json_str;var images_src=new Array();images_src=eval(json_str);$("present_image_"+listingId).setAttribute("src",images_src[currentImageIndex]);if(totalImagesCount>0){if(totalImagesCount==1){$("prev_link_"+listingId).innerHTML="";$("next_link_"+listingId).innerHTML=""}else{previousLink=document.createElement("a");previousLink.setAttribute("href","javascript:void(0);");previousLink.setAttribute("id","prev_link_id_"+listingId);if(window.addEventListener){previousLink.addEventListener("click",function(){PropertySearchPage.slideImages(currentImageIndex-1,totalImagesCount,listingId,json_str)},false)}else{if(window.attachEvent){previousLink.attachEvent("onclick",function(){PropertySearchPage.slideImages(currentImageIndex-1,totalImagesCount,listingId,json_str)})}else{previousLink.onclick=function(){PropertySearchPage.slideImages(currentImageIndex-1,totalImagesCount,listingId,json_str)}}}previousLink.innerHTML="Prev|";nextLink=document.createElement("a");nextLink.setAttribute("href","javascript:void(0);");nextLink.setAttribute("id","next_link_id_"+listingId);if(window.addEventListener){nextLink.addEventListener("click",function(){PropertySearchPage.slideImages(currentImageIndex+1,totalImagesCount,listingId,json_str)},false)}else{if(window.attachEvent){nextLink.attachEvent("onclick",function(){PropertySearchPage.slideImages(currentImageIndex+1,totalImagesCount,listingId,json_str)})}else{nextLink.onclick=function(){PropertySearchPage.slideImages(currentImageIndex+1,totalImagesCount,listingId,json_str)}}}nextLink.innerHTML="Next";if(currentImageIndex==0){$("prev_link_"+listingId).innerHTML="";$("prev_link_"+listingId).innerHTML="Prev|";$("next_link_"+listingId).innerHTML="";$("next_link_"+listingId).appendChild(nextLink)}else{if(currentImageIndex==totalImagesCount-1){$("prev_link_"+listingId).innerHTML="";$("prev_link_"+listingId).appendChild(previousLink);$("next_link_"+listingId).innerHTML="";$("next_link_"+listingId).innerHTML="Next"}else{$("prev_link_"+listingId).innerHTML="";$("prev_link_"+listingId).appendChild(previousLink);$("next_link_"+listingId).innerHTML="";$("next_link_"+listingId).appendChild(nextLink)}}}}},addFormHiddenField:function(formName,eleIdPrefix,eleName,eleValue){var form=$(formName);if(form){var id=eleIdPrefix+this.HIDDEN_FIELD_POSTFIX;var hiddenField=new Element("input",{type:"hidden",name:eleName,value:eleValue,id:id});form.appendChild(hiddenField)}},removeHiddenField:function(formName,eleIdPrefix){var form=$(formName);if(form){var id=eleIdPrefix+this.HIDDEN_FIELD_POSTFIX;element=$(id);if(element){form.removeChild(element)}}},clearPrices:function(fetchResult){},clearFilters:function(){$("clf").value="1";$("min_inr").value="";$("max_inr").value="";handleBudgetValues($("search_intent_hidden").value);$("bed_rooms").value="";$("bath_rooms").value="";$("direction_facing").value="All";$("flooring").value="All";$("servant_accommodation").value="All";$("builtup_min").value="Min";$("builtup_max").value="Max";PropertySearchPage.handleCheckBoxFilters("house_type","false");PropertySearchPage.handleCheckBoxFilters("furnish_state",false);PropertySearchPage.handleCheckBoxFilters("posted_by","true");PropertySearchPage.handleCheckBoxFilters("ownership","true");handle2WheelerParking();handle4WheeleParkingValues();handleBedrooms();handleBathrooms();handleAmenties();handleFlooring();handleDirectionOfFacing();handleServantAccom();handlePropertyAge();$("available_from").selectedIndex=0;Event.fire($("available_from"),"liszt:updated");Event.fire($("available_from"),"liszt:reset");this.fetchAds();this.isPopularLocalityCountRequired=-10;this.isNearByLocalityCountRequired=-10;this.filterEventHandler()},newPopupTemplateTopWithLeftArrow:'<div class="arrow" id="modal_arrow"><img width="11" height="13" src="/images/send_message/arrow.png"></div><div class="popuptop"></div><div class="popupcenter"><a href="javascript:void(0)" onclick="newMessageObj.close()" id="iframe_close"><span class="close"></span></a>',newPopupTemplateBottomWithLeftArrow:'</div><div class="popupbottom"></div>',showSendMessageMobile:function(){$("listing_loader").show();$$(".full-listing-aside-inner")[0].innerHTML="";new Ajax.Request("/property-listing-public/responsive-send-message?"+$("send-message-form-virtual").serialize(),{method:"GET",onSuccess:function(transport){$$(".full-listing-aside-inner")[0].innerHTML=transport.responseText;if(jQuery("#enter-details").length>0){_gaq.push(["_trackEvent","Mobile Web Contact Flow","Form Screen","On Display"])}PropertySearchPage.evalScript($$(".full-listing-aside-inner")[0])},onFailure:function(transport){alert("Could not connect to CommonFloor Server for this request")},onComplete:function(transport){$("listing_loader").hide()}});window.location.href="#contact"},showViewContactInfoBox:function(listingId,source,elem,listingDetails,searchResults,pageType,view,isPageResponsive){elem=$(elem);var offs=elem.cumulativeOffset();view=view||"vert";height=350;action="view-contact-info";if(view=="owner"){var args=arguments;if(!this.vciAuthCheck(args)){return}height=350}if(!isPageResponsive){newMessageObj.setOffset(offs[0]+elem.getWidth()+7,PropertySearchPage.getTopOffset(elem,50));newMessageObj.setSize(100,50);newMessageObj.setUserClass("modalPopup");newMessageObj.setShadowDivVisible(true)}else{}var isAggregated="0";if(searchResults=="other"){searchResults="Relevant listing "}else{if(searchResults=="agg"){searchResults="Aggregated ";isAggregated="1"}else{if(searchResults=="Project Overview"){searchResults="Project Overview "}else{searchResults=""}}}if(view=="owner"){searchResults+=(searchResults.length==0?"":" ")+"Owner"}if(pageType!=undefined){searchResults=pageType+" "+searchResults}var trk_caller=null;if(pageType=="Full Listing Top"||pageType=="Full Listing Bottom"){trk_caller="full-detail"}var details=[],num=0;if(listingDetails===Object(listingDetails)){details.push("");if(listingDetails.hasOwnProperty("position")){num=listingDetails.position;delete listingDetails.position}if(listingDetails.hasOwnProperty("viewContactInfoReminder")){var is_vci_reminder=listingDetails.viewContactInfoReminder;delete listingDetails.viewContactInfoReminder}if(listingDetails.hasOwnProperty("sendMessageReminder")){delete listingDetails.sendMessageReminder}for(var i in listingDetails){if(listingDetails.hasOwnProperty(i)){details.push(i+":"+listingDetails[i])}}}if(is_vci_reminder){_gaq.push(["_trackEvent",searchResults+"View Contact Info - Reminder","Button Click","listing_id:"+listingId+details.join("|"),num])}else{_gaq.push(["_trackEvent",searchResults+"View Contact Info","Button Click","listing_id:"+listingId+details.join("|"),num])}if(!isPageResponsive){newMessageObj.setHtmlContent(PropertySearchPage.newPopupTemplateTopWithLeftArrow+'<iframe id="modal_msg_frame" src="/property-listing-public/'+action+"?listing_id="+listingId+"&contact_source="+source+"&aggregated="+isAggregated+"&listing_type=property&search_result_type="+searchResults+"&view="+view+"&vci_reminder="+is_vci_reminder+"&trk_caller="+trk_caller+"&ispageresponsive="+isPageResponsive+'" width="375px" height="'+height+'px" frameborder="0" scrolling="no" onLoad="PropertySearchPage.autoResizeIframe(\'modal_msg_frame\');" style="padding:0px 5px;"></iframe>'+PropertySearchPage.newPopupTemplateBottomWithLeftArrow);if(jQuery(".listing_snippet").length==0&&jQuery(".listing-col").length==0){if(jQuery("#lightbox-contact").is(":empty")){jQuery("#lightbox-contact").append(newMessageObj.htmlOfModalMessage)}var sliderLightBox=new LightBox("contact_btn","lightbox-contact",function(){jQuery("#iframe_close .close").addClass("popup-close");jQuery(".arrow").addClass("hide")},function(){jQuery("#lightbox-contact").empty()})}else{var topOffset=PropertySearchPage.getTopOffset(elem,340);newMessageObj.setOffset(offs[0]+elem.getWidth()+7,topOffset);newMessageObj.setSize(height+30);newMessageObj.display();$("modal_arrow").style.top=(offs[1]-topOffset+7)+"px"}}else{if(view=="json"&&isPageResponsive){var loader=$("listing_loader");if(loader){loader.show()}var listingparams="listing_id="+listingId+"&contact_source="+source+"&aggregated="+isAggregated+"&listing_type=property&search_result_type="+searchResults+"&view="+view;new Ajax.Request("/property-listing-public/"+action+"/",{method:"GET",dataType:"json",parameters:listingparams,onSuccess:function(transport){var tt=JSON.parse(transport.responseText);window.location="tel:"+tt.phonenum},onFailure:function(transport){alert("Could not connect to CommonFloor Server for this request")},onComplete:function(transport){if(loader){loader.hide()}}})}else{if(isPageResponsive){$$(".full-listing-aside-inner")[0].innerHTML="";$("listing_loader").show();new Ajax.Request("/property-listing-public/"+action+"?listing_id="+listingId+"&contact_source="+source+"&aggregated="+isAggregated+"&listing_type=property&search_result_type="+searchResults+"&view="+view+"&isPageResponsive="+isPageResponsive,{method:"GET",onSuccess:function(transport){$$(".full-listing-aside-inner")[0].innerHTML=transport.responseText;PropertySearchPage.evalScript($$(".full-listing-aside-inner")[0])},onFailure:function(transport){alert("Could not connect to CommonFloor Server for this request")},onComplete:function(transport){if(loader){loader.hide()}$("listing_loader").hide()}})}else{contactFormLightbox.setHtml('<iframe id="modal_msg_frame" src="/property-listing-public/'+action+"?listing_id="+listingId+"&contact_source="+source+"&aggregated="+isAggregated+"&listing_type=property&search_result_type="+searchResults+"&view="+view+"&ispageresponsive="+isPageResponsive+'"  width="300px" height="390px;" frameborder="0" scrolling="yes" style="padding:0 0 5px 5px;overflow-x: hidden; overflow-y: auto"></iframe>');contactFormLightbox.open()}}}},vciAuthCheck:function(args){if($("user_welcome_msg")||$$("a[href=/logout]").length==1){return true}authorize=new Authorize("VCI Check","public",null,null,function(){PropertySearchPage.showViewContactInfoBox.apply(PropertySearchPage,args)},null,"no",null,null,true);authorize.showAuthorizeForm();return false},showRequestForImageBox:function(listingId,source,elem,listingType,searchResults){elem=$(elem);var offs=elem.cumulativeOffset();var isAggregated="0";if(searchResults=="other"){searchResults="Relevant listing "}else{if(searchResults=="agg"){searchResults="Aggregated ";isAggregated="1"}else{searchResults=""}}_gaq.push(["_trackEvent","send_message",searchResults+"Request for Images","listing_id:"+listingId]);new Ajax.Request("/property-listing-public/show-send-message",{method:"GET",parameters:"rfi=1&listing_id="+listingId+"&contact_source="+source+"&listing_type="+listingType+"&aggregated="+isAggregated,onSuccess:function(transport){newMessageObj.setHtmlContent(PropertySearchPage.newPopupTemplateTopWithLeftArrow+transport.responseText+PropertySearchPage.newPopupTemplateBottomWithLeftArrow);var topOffset=PropertySearchPage.getTopOffset(elem,180);newMessageObj.setOffset(offs[0]+elem.getWidth()+7,topOffset);newMessageObj.setSize(350);newMessageObj.display();$("modal_arrow").style.top=(offs[1]-topOffset+3)+"px"}});newMessageObj.setOffset(offs[0]+elem.getWidth()+7,PropertySearchPage.getTopOffset(elem,50));newMessageObj.setSize(100,50);newMessageObj.setUserClass("modalPopup");newMessageObj.setHtmlContent("<div align='center'><b>Loading...</b></div>");newMessageObj.setShadowDivVisible(true);newMessageObj.display()},autoResizeIframe:function(id){var newheight;var newwidth;if(document.getElementById){newheight=document.getElementById(id).contentWindow.document.body.scrollHeight;newwidth=document.getElementById(id).contentWindow.document.body.scrollWidth}if(typeof(document.getElementById(id).contentWindow.document.getElementById("page"))!="undefined"&&document.getElementById(id).contentWindow.document.getElementById("page")!=null){newheight=document.getElementById(id).contentWindow.document.getElementById("page").scrollHeight}document.getElementById(id).height=(newheight+20)+"px";document.getElementById(id).width=(newwidth+5)+"px"},showSendMessageBox:function(listingId,source,elem,listingType,listingDetails,searchResults,pageType,defaultMessage,isMobile){elem=$(elem);var offs=elem.cumulativeOffset();var offs1=elem.cumulativeScrollOffset();offs[0]-=offs1[0];if(defaultMessage!=undefined&&defaultMessage!=false){defaultMessage="&sender_message="+defaultMessage+"&rfp=1"}else{defaultMessage=""}if(!isMobile){newMessageObj.setOffset(offs[0]+elem.getWidth()+7,PropertySearchPage.getTopOffset(elem,50));newMessageObj.setSize(100,50);newMessageObj.setUserClass("modalPopup");newMessageObj.setShadowDivVisible(true)}var isAggregated="0";if(searchResults=="other"){searchResults="Relevant listing "}else{if(searchResults=="agg"){searchResults="Aggregated ";isAggregated="1"}else{if(searchResults=="Project Overview"){searchResults="Project Overview "}else{searchResults=""}}}if(listingType=="requirement"){searchResults="Requirement "+searchResults}if(pageType!=undefined){searchResults=pageType+" "+searchResults}var details=[],num=0;if(listingDetails===Object(listingDetails)){details.push("");if(listingDetails.hasOwnProperty("position")){num=listingDetails.position;delete listingDetails.position}if(listingDetails.hasOwnProperty("viewContactInfoReminder")){delete listingDetails.viewContactInfoReminder}if(listingDetails.hasOwnProperty("sendMessageReminder")){var is_sm_reminder=listingDetails.sendMessageReminder;delete listingDetails.sendMessageReminder}for(var i in listingDetails){if(listingDetails.hasOwnProperty(i)){details.push(i+":"+listingDetails[i])}}}if(is_sm_reminder){_gaq.push(["_trackEvent",searchResults+"Send Message - Reminder","Button Click","listing_id:"+listingId+details.join("|"),num])}else{_gaq.push(["_trackEvent",searchResults+"Send Message","Button Click","listing_id:"+listingId+details.join("|"),num])}if(!isMobile){newMessageObj.setHtmlContent(PropertySearchPage.newPopupTemplateTopWithLeftArrow+'<iframe id="modal_msg_frame" src="/property-listing-public/send-message?listing_id='+listingId+"&contact_source="+source+"&listing_type="+listingType+"&search_result_type="+searchResults+"&aggregated="+isAggregated+"&sm_reminder="+is_sm_reminder+defaultMessage+'"  width="365px" height="385px" frameborder="0" scrolling="no" onLoad="PropertySearchPage.autoResizeIframe(\'modal_msg_frame\');" style="padding:0px 5px;"></iframe>'+PropertySearchPage.newPopupTemplateBottomWithLeftArrow);var topOffset=PropertySearchPage.getTopOffset(elem,405);newMessageObj.setOffset(offs[0]+elem.getWidth()+7,topOffset);newMessageObj.setSize(400);newMessageObj.display();$("modal_arrow").style.top=(offs[1]-topOffset+7)+"px"}else{contactFormLightbox.setHtml('<iframe id="modal_msg_frame" src="/property-listing-public/send-message?listing_id='+listingId+"&contact_source="+source+"&listing_type="+listingType+"&search_result_type="+searchResults+"&aggregated="+isAggregated+"&sm_reminder="+is_sm_reminder+defaultMessage+'"  width="300px" height="390px" frameborder="0" scrolling="no" onLoad="PropertySearchPage.autoResizeIframe(\'modal_msg_frame\');" style="padding:0px 5px;"></iframe>');contactFormLightbox.open()}},getTopOffset:function(eventSourceEle,popUpHeight){var offset;var bodyHeight;var eventSourceEleHeight=eventSourceEle.getHeight();var topOffset;var bottomOffset;var eventSourceEleTopOffset;var eventSourceEleBottomOffset;var isFreeSpaceNotAvailableOnTop;var isFreeSpaceNotAvailableOnBottom;var neededFreeSpace=Math.round((popUpHeight-eventSourceEleHeight)/2);if(self.innerHeight){bodyHeight=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){bodyHeight=document.documentElement.clientHeight}else{if(document.body){bodyHeight=document.body.clientHeight}}}topOffset=Math.max(document.body.scrollTop,document.documentElement.scrollTop);bottomOffset=topOffset+bodyHeight;var offs=eventSourceEle.cumulativeOffset();eventSourceEleTopOffset=offs[1];eventSourceEleBottomOffset=eventSourceEleTopOffset+eventSourceEleHeight;isFreeSpaceNotAvailableOnTop=(eventSourceEleTopOffset-topOffset<neededFreeSpace);isFreeSpaceNotAvailableOnBottom=(bottomOffset-eventSourceEleBottomOffset<neededFreeSpace);if(eventSourceEleBottomOffset>bottomOffset){Position.prepare();window.scrollTo(Position.deltaX,eventSourceEleBottomOffset-bodyHeight);var tmp=this.getTopOffset(eventSourceEle,popUpHeight);return tmp}if(isFreeSpaceNotAvailableOnTop){offset=topOffset}else{if(isFreeSpaceNotAvailableOnBottom){offset=bottomOffset-popUpHeight}else{offset=eventSourceEleTopOffset-neededFreeSpace}}return offset},getTopOffsetForTopArrow:function(eventSourceEle,popUpHeight){var eventSourceEleHeight=eventSourceEle.getHeight();var offs=eventSourceEle.cumulativeOffset();var eventSourceEleTopOffset=offs[1];var eventSourceEleBottomOffset=eventSourceEleTopOffset+eventSourceEleHeight;return eventSourceEleBottomOffset+6},showRealestatePublicUserSendMessageBox:function(listingId,userType,source){var url="";var params="";if(userType!="public"){url+="/user-requirement/send-form";params+="listing_id="+listingId}else{url+="/show-realestate-public-message";params+="listing_id="+listingId+"&user_type=public"}params+="&flow=contact";if(source){params+=("&contact_source="+source)}new Ajax.Request(url,{method:"GET",parameters:params,onSuccess:function(transport){messageObj.setHtmlContent(transport.responseText);messageObj.setSize(480,550);messageObj.setCssClassMessageBox(false);messageObj.setSource(false);messageObj.setShadowDivVisible(true);messageObj.display()}});messageObj.setSize(100,50);messageObj.setHtmlContent("<div align='center'><b>Loading...</b></div>");messageObj.setCssClassMessageBox(false);messageObj.setSource(false);messageObj.setShadowDivVisible(true);messageObj.display()},showPromotionalPropertyContact:function(propertyId){new Ajax.Request("/property-listing-public/show-promotional-property-contact-form",{method:"GET",parameters:"pi="+propertyId,onSuccess:function(transport){messageObj.setHtmlContent(transport.responseText);messageObj.setSize(369,348);messageObj.setCssClassMessageBox(false);messageObj.setSource(false);messageObj.setShadowDivVisible(true);messageObj.display()}});messageObj.setSize(100,50);messageObj.setHtmlContent("<div align='center'><b>Loading...</b></div>");messageObj.setCssClassMessageBox(false);messageObj.setSource(false);messageObj.setShadowDivVisible(true);messageObj.display()},newPopupTemplateTopWithTopArrow:'<div class="arrow_top" id="modal_top_arrow"><img width="13" height="11" src="/images/send_message/arrow_top.png"></div><div class="popuptop"></div><div class="popupcenter"><a href="javascript:void(0)" onclick="newMessageObj.close()" id="iframe_close"><span class="close"></span></a>',newPopupTemplateBottomWithTopArrow:'</div><div class="popupbottom"></div>',showNewPromotionalPropertyContact:function(propertyId,elem,userId){elem=$(elem);var offs=elem.cumulativeOffset();var userId=userId||null;new Ajax.Request("/property-listing-public/show-promotional-property-contact-form",{method:"GET",parameters:"pi="+propertyId+"&type=send_message&uid="+userId,onSuccess:function(transport){newMessageObj.setHtmlContent(PropertySearchPage.newPopupTemplateTopWithTopArrow+transport.responseText+PropertySearchPage.newPopupTemplateBottomWithTopArrow);var topOffset=PropertySearchPage.getTopOffsetForTopArrow(elem,348);var leftOffset=offs[0]+(elem.getWidth()/2)-200;var arrow_leftOffset=8+offs[0];if(leftOffset<0){leftOffset=0;arrow_leftOffset=offs[0]+(elem.getWidth()/2)}newMessageObj.setOffset(leftOffset,topOffset);newMessageObj.setSize(400,270);newMessageObj.display();$("modal_top_arrow").style.left=arrow_leftOffset+"px";$("modal_top_arrow").style.top=(offs[1]-topOffset+27)+"px"}});newMessageObj.setOffset(offs[0]+elem.getWidth()+7,PropertySearchPage.getTopOffsetForTopArrow(elem,50));newMessageObj.setSize(100,50);newMessageObj.setUserClass("modalPopup");newMessageObj.setHtmlContent("<div align='center'><b>Loading...</b></div>");newMessageObj.setShadowDivVisible(true);newMessageObj.display()},showNewPromotionalPropertyInfo:function(propertyId,elem,userId){elem=$(elem);var offs=elem.cumulativeOffset();var userId=userId||null;new Ajax.Request("/property-listing-public/show-promotional-property-contact-form",{method:"GET",parameters:"pi="+propertyId+"&type=vci&uid="+userId,onSuccess:function(transport){newMessageObj.setHtmlContent(PropertySearchPage.newPopupTemplateTopWithTopArrow+transport.responseText+PropertySearchPage.newPopupTemplateBottomWithTopArrow);var topOffset=PropertySearchPage.getTopOffsetForTopArrow(elem,348);var leftOffset=offs[0]+(elem.getWidth()/2)-200;var arrow_leftOffset=8+offs[0];if(leftOffset<0){leftOffset=0;arrow_leftOffset=offs[0]+(elem.getWidth()/2)}newMessageObj.setOffset(leftOffset,topOffset);newMessageObj.setSize(400,270);newMessageObj.display();$("modal_top_arrow").style.left=arrow_leftOffset+"px";$("modal_top_arrow").style.top=(offs[1]-topOffset+27)+"px"}});newMessageObj.setOffset(offs[0]+elem.getWidth()+7,PropertySearchPage.getTopOffsetForTopArrow(elem,50));newMessageObj.setSize(100,50);newMessageObj.setUserClass("modalPopup");newMessageObj.setHtmlContent("<div align='center'><b>Loading...</b></div>");newMessageObj.setShadowDivVisible(true);newMessageObj.display()},showContactRequirementsPosterSendMessageBox:function(poolId,userType){var url="";var params="";if(userType!="public"){url+="/user-requirement/send-form";params+="pool_id="+poolId}else{url+="/show-realestate-public-message";params+="user_type=public&pool_id="+poolId}params+="&flow=contact_requirements_poster";new Ajax.Request(url,{method:"GET",parameters:params,onSuccess:function(transport){messageObj.setHtmlContent(transport.responseText);messageObj.setSize(480,550);messageObj.setCssClassMessageBox(false);messageObj.setSource(false);messageObj.setShadowDivVisible(true);messageObj.display()}});messageObj.setSize(100,50);messageObj.setHtmlContent("<div align='center'><b>Loading...</b></div>");messageObj.setCssClassMessageBox(false);messageObj.setSource(false);messageObj.setShadowDivVisible(true);messageObj.display()},showRealestatePostRequirementBox:function(userType,source){var url="";var params="";if(userType!="public"){url+="/user-requirement/send-form";params+="flow=post_requirement"}else{url+="/show-realestate-public-message";params+="user_type=public&flow=post_requirement"}if(source){url+=("?f="+source)}new Ajax.Request(url,{method:"GET",parameters:params,onSuccess:function(transport){messageObj.setHtmlContent(transport.responseText);messageObj.setSize(620,530);messageObj.setCssClassMessageBox(false);messageObj.setSource(false);messageObj.setShadowDivVisible(true);messageObj.display()}});messageObj.setSize(100,50);messageObj.setHtmlContent("<div align='center'><b>Loading...</b></div>");messageObj.setCssClassMessageBox(false);messageObj.setSource(false);messageObj.setShadowDivVisible(true);messageObj.display()},showManageListingsLinkPostBox:function(){new Ajax.Request("/property-listing-public/show-form",{method:"GET",parameters:"flow=manage-listings",onSuccess:function(transport){messageObj.setHtmlContent(transport.responseText);messageObj.setSize(620,390);messageObj.setCssClassMessageBox(false);messageObj.setSource(false);messageObj.setShadowDivVisible(true);messageObj.display()}});messageObj.setSize(100,50);messageObj.setHtmlContent("<div align='center'><b>Loading...</b></div>");messageObj.setCssClassMessageBox(false);messageObj.setSource(false);messageObj.setShadowDivVisible(true);messageObj.display()},showRealestateRequestMoreInfoBox:function(listingId,userType){var url="";var params="";if(userType!="public"){url+="/property-listing/send-listing-request-form";params+="listing_id="+listingId}else{url+="/show-request-more-realestate-listing-info-form";params+="listing_id="+listingId+"&user_type=public"}new Ajax.Request(url,{method:"GET",parameters:params,onSuccess:function(transport){messageObj.setHtmlContent(transport.responseText);messageObj.setSize(480,550);messageObj.setCssClassMessageBox(false);messageObj.setSource(false);messageObj.setShadowDivVisible(true);messageObj.display()}});messageObj.setSize(100,50);messageObj.setHtmlContent("<div align='center'><b>Loading...</b></div>");messageObj.setCssClassMessageBox(false);messageObj.setSource(false);messageObj.setShadowDivVisible(true);messageObj.display()},handlePropDetailsLink:function(id){if($(id+"_details").visible()){$(id+"_details").next().simulate("click")}else{$(id+"_details").previous().simulate("click");try{if($("iframe_src_"+id)&&$("iframe_"+id).src=="about:blank"){$("iframe_"+id).src=$("iframe_src_"+id).value}}catch(err){alert(err)}}},handleModificationHistory:function(id){if($(id+"_mod_history").visible()){$(id+"_mod_history").hide()}else{new Ajax.Request("/content/realestate-broker/show-modification-history",{method:"GET",parameters:"listing_id="+id,onSuccess:function(modifications){if(modifications.responseText){$(id+"_mod_history").innerHTML=modifications.responseText;var element=document.createElement("input");element.type="button";element.value="Confirm Changes";element.name="confirmChanges";element.style.backgroundColor="yellow";element.onclick=function(){PropertyListing.confirmModification(id)};$(id+"_mod_history").appendChild(element);$(id+"_mod_history").style.backgroundColor="#424242"}else{alert("Oops! Some problem occured, while loading block info.")}},onFailure:function(modifications){alert("Oops! Some problem occured.")}});$(id+"_mod_history").show()}},handleDetailsLink:function(id){if($(id+"_details").visible()){$(id+"_details").hide()}else{$(id+"_details").show();try{if($("iframe_src_"+id)&&$("iframe_"+id).src=="about:blank"){$("iframe_"+id).src=$("iframe_src_"+id).value}}catch(err){alert(err)}}},addAreaToListing:function(id){if(!id){return}$("check_"+id).checked=true;$("listing_edited").value=id;$("tr_"+id).setStyle({backgroundColor:"#F5F6CE",color:"blue"})},addSelectedLocalityToListing:function(area_name,area_id){var id=$("listing_edited").value;$("area_"+id).value=area_name;$("area_id_"+id).value=area_id;$("city_"+id).value=$("city").value;$("tr_"+id).setStyle({backgroundColor:"#00FFFF",color:"blue"});return},addSelectedCommunityToListing:function(apt_name,prop_id){var id=$("listing_edited").value;$("name_"+id).value=apt_name;$("property_id_"+id).value=prop_id;$("city_"+id).value=$("city").value;$("tr_"+id).setStyle({backgroundColor:"#00FFFF",color:"blue"});return},handleNearbyAreasCheckbox:function(){var localities=$(this.HIDDEN_FIELDS_CONTAINER).childElements().length;if(localities>0){PropertySearchPage.filterEventHandler(1,$("consider_nearby_areas"))}},getBrokerListingContactInfo:function(listingId){$("listing_loader").show();new Ajax.Request("/property-listing-public/broker-listing-contact-details",{method:"POST",parameters:"li="+listingId,onSuccess:function(transport){$("listing_loader").hide();var text=transport.responseText;var returnValueParts=text.split("|");if(/0/.test(returnValueParts[0])){alert(returnValueParts[1])}else{$(listingId+"_broker_contact_info").innerHTML=returnValueParts[1];$(listingId+"_broker_contact_info").style.display="block";$(listingId+"_get_broker_contact_info").hide()}},onFailure:function(transport){$("listing_loader").hide();alert("Sorry unable to get the contact details. Please contact support@commonfloor.com to get the Infomation about this listing.")}})},handleListingFiltersVisibility:function(listingsType,refreshFilters){if(listingsType=="property"){$("expand").show();$("expand_button").show();$("sale_type_div").show();$("sf_content").removeClassName("sfcontent_req");$("posted_by_builder").show();$("posted_by_builder_label").show();$("posted_by_owner_label").update("Owner");if(refreshFilters!=false){PropertySearchPage.handleCheckBoxFilters("posted_by","true")}var extend_value=$("expand_value").value;if(extend_value==1){$("expand_value").value=0;$("expand_text").update("Show Less Options");$("expand_text").removeClassName("sfbicon_plus");$("expand_text").addClassName("sfbicon")}else{if(extend_value==0){$("expand_value").value=1;$("expand_text").update("Show More Options");$("expand_text").removeClassName("sfbicon");$("expand_text").addClassName("sfbicon_plus")}}}else{if(listingsType=="requirement"){$("expand_value").value=1;$("posted_by_builder").hide();$("sf_content").addClassName("sfcontent_req");$("posted_by_builder_label").hide();$("posted_by_owner_label").update("Seeker");if(refreshFilters!=false){PropertySearchPage.handleCheckBoxFilters("posted_by","true")}$("expand").hide();$("expand_button").hide()}}},handleCheckBoxFilters:function(ele,type_flag){var elements=document.getElementsByName(ele+"[]");if(elements){for(var i=0;i<elements.length;i++){elements[i].checked=type_flag}}if(ele=="house_type"){updateDiv("house_type")}if(ele=="furnish_state"){updateDiv("furnish_state")}},handleContactAuthorize:function(listingsType,listingId,owner){var functions;if(listingsType=="property"){functions={};functions["PropertySearchPage.showSendMessageBox"]=new Array(listingId,"public")}else{functions={};functions["PropertySearchPage.showSendMessageBox"]=new Array(listingId,"public")}authorize=new Authorize("Contact "+owner,"public","","",functions,"listing_loader","no");authorize.showAuthorizeForm()},detectHistorySupport:function(){return !!(window.history&&history.pushState)},fetchExtraResults:function(page,eventObj,infScroll,isMobile){if(($("requirement_request")!=undefined&&$("requirement_request").value==1)){return}if(page==undefined){page=1}if(infScroll==undefined){infScroll=false}if(isMobile){form_parameter=jQuery("#property_listing_input_options").serialize()}else{form_parameter=$("property_listing_input_options").serialize()}var pageSize=this.relevantResultPageSize;var url="/relevant-listings";var search_intent_value="";var sortBy="";if($("listings_sort_by")!=undefined){sortBy=$("listings_sort_by").value}if($("search_intent_hidden")!=undefined){search_intent_value=$("search_intent_hidden").value}var conditional="";if(!infScroll){$("listing_loader").show()}else{conditional="&req=-1";if(page!=1){page+=(pageSize-this.infScrollPageSize)/this.infScrollPageSize;pageSize=this.infScrollPageSize}}new Ajax.Request(url,{method:"POST",parameters:form_parameter+"&page="+page+"&r=a&srtby="+sortBy+"&page_size="+pageSize+conditional,onSuccess:function(transport){if(transport.responseText){var splitter=transport.responseText.indexOf("#!#");var currReqNo=0;if(splitter==-1){currReqNo=-1;splitter=0}else{currReqNo=transport.responseText.substr(0,splitter);splitter+=3}transport.responseText=transport.responseText.substr(splitter);if(infScroll){var nextPage=document.createElement("div"),num1=((page-1)*pageSize)+1,num2=num1+pageSize-1;if($("sponsored_listing_id").value){num1++;num2++}if(num2>parseInt($("other_search_results_count_hidden").value)){num2=$("other_search_results_count_hidden").value}if(isMobile){nextPage.innerHTML=""}else{nextPage.innerHTML="<div class='page_hr' style='color:#4D4D4D'><hr/><div>Showing results: <span class='showing_result'>"+num1+"-"+num2+"</span></div><hr/></div>"}nextPage.innerHTML+=transport.responseText;PropertySearchPage.evalScript(nextPage);$("results_div1").appendChild(nextPage);if(typeof jQuery.cfitrack!=="undefined"){jQuery(nextPage).find(".listing_snippet").cfitrack({commonDataElement:jQuery("#cfi_listing_common_data")})}$("results_div1").fire("inf:pageSuccess")}else{$("results_div1").fire("inf:stop");if(typeof jQuery.cfitrack!=="undefined"){jQuery("#results_div1 .listing_snippet").cfitrack("destroy")}$("results_div1").update(transport.responseText);if(typeof jQuery.cfitrack!=="undefined"){jQuery("#results_div1 .listing_snippet").cfitrack({commonDataElement:jQuery("#cfi_listing_common_data")})}PropertySearchPage.bindMinimize();if($("other_search_results_last_page").value>1){$("other_search_results_last_page").value=1+Math.ceil((parseInt($("other_search_results_count_hidden").value)-pageSize)/PropertySearchPage.infScrollPageSize)}$("results_div1").fire("inf:reset");$("results_div1").fire("inf:start")}if($("other_search_results_count_hidden").value!="0"){_gaq.push(["_trackEvent","Relevant Listing result","showing result","",pageSize]);$("close_results").show();if($("search_results_count_hidden").value!="0"){$("other_search_results_count").innerHTML="Apart from the accurate property matches listed above,<br> here are a few properties that closely match your selection criteria.<br><br><hr>";$("close_results").style.margin="0px"}else{$("other_search_results_count").innerHTML="Here are a few  properties that closely match your selection criteria.<br><br><hr>";$("close_results").style.margin="-35px 0 0"}}else{$("close_results").hide();$("other_search_results_count").innerHTML=""}}else{$("results_div1").update();$("close_results").hide();$("other_search_results_count").innerHTML=""}if(!isMobile){reorderPaginationPanel(-1);initiateFlexsliderAfterAjaxCall()}},onFailure:function(transport){alert("Could not connect to CommonFloor Server for this request");$("results_div1").fire("inf:pageFaliure")},onComplete:function(transport){if(!isMobile){initiateFlexsliderAfterAjaxCall()}if(!infScroll){$("listing_loader").hide()}}})},bindMinimize:function(){$$(".minimize span.more").each(function(v){v.observe("click",function(){v.hide();v.previous().hide();v.next(1).show();v.next().show();_gaq.push(["_trackEvent","Buy rent tab","show more detail","show more detail"])})});$$(".minimize span.less").each(function(v){v.hide();v.observe("click",function(){v.hide();v.previous(1).show();v.previous(2).show();v.previous().hide();_gaq.push(["_trackEvent","Buy rent tab","hide more detail","hide more detail"])})})},trackView:function(id){new Ajax.Request("/dashboard/track-view/",{method:"GET",parameters:"t=l&u="+id,onSuccess:function(transport){},onFailure:function(transport){}})},sendAjaxRequestToFullDetailPage:function(id){new Ajax.Request("/listing/basic-listing/"+id,{method:"POST",onSuccess:function(transport){},onFailure:function(transport){}})},handleSaleType:function(search_intent){if(search_intent=="sale"||search_intent=="buy"){$("sale_type_div").show();$("search_intent_sale").removeClassName("unselected_class");$("search_intent_rent").addClassName("unselected_class")}else{if(search_intent=="rent"){$("sale_type_div").hide();$("search_intent_rent").removeClassName("unselected_class");$("search_intent_sale").addClassName("unselected_class")}}},handlePropertyType:function(clickedElement){if(clickedElement.id=="show_prop"){$("listings_type").value="property"}else{if(clickedElement.id=="show_req"){$("listings_type").value="requirement"}}PropertySearchPage.handleListingFiltersVisibility($("listings_type").value);PropertySearchPage.fetchResults(1,$("listings_type"))},handleProjectDetail:function(property_id,listing_type,listing_id,tracking_info){if($("project_details_"+listing_id)==undefined||$("project_details_"+listing_id)==null){new Ajax.Request("/property-Listing/about-project?property_id="+property_id+"&listing_type="+listing_type+"&listing_id="+listing_id+"&tracking_info="+tracking_info,{method:"GET",onSuccess:function(transport){$("about_project_"+listing_id).innerHTML=transport.responseText;handleMoreDetail(listing_id,1)}})}else{handleMoreDetail(listing_id,1)}},handleFeaturedPropertyAdsShowMore:function(){var more_featured_ads_container=$("featured_ads_more");var show_more_button=$$(".showMore_btn");if(more_featured_ads_container.getStyle("display")=="none"||more_featured_ads_container.getStyle("display")==null){show_more_button[0].update("Show Less");$("featured_ads_more").show();_gaq.push(["_trackEvent","Adsclick","propertySearchAd","showMore"])}else{show_more_button[0].update("Show More");$("featured_ads_more").hide();_gaq.push(["_trackEvent","Adsclick","propertySearchAd","showLess"])}},saveSeenListing:function(listing_id,login_id){var entity="LISTING";var entity_id=listing_id;var user_email=login_id;var source="full-listings-detail-page";var url="/property-listing-public/add-entity-view";new Ajax.Request(url,{method:"POST",parameters:{et:entity,e_id:entity_id,src:source,ue:user_email},onSuccess:function(transport){var result=transport.responseText.evalJSON();if(result.status==1){}}})},showSuccessfulMessage:function(lid,contacted_date,context,view_type,trk_caller){if(view_type=="vert"){var notification_container=$$("."+lid+" .already_contacted");notification_container=notification_container[0];if(context=="sm"){var sm_container=$$("."+lid+" .send_msg");sm_container=sm_container[0];if($(sm_container!=undefined)&&$(notification_container!=undefined)){sm_container.update("Send Reminder");sm_container.addClassName("v_indicator");notification_container.update('<span class="already_contacted_image"></span><span>Contacted On <b>'+contacted_date+"</b></span>")}}else{if(context=="vci"){if(jQuery("#dashboard").length!=0){jQuery(".dashboard_table tr").each(function(){var listing_id=jQuery(this).find("span.delete_btn").attr("data-lid");if(listing_id==lid){jQuery(this).find(".is_vci").val(contacted_date);jQuery(this).find("td.contact_info .contact_btn").css("background","#F58706 url('/images/shortlist_sprite.png') no-repeat 8px -55px")}})}else{if(trk_caller=="full-detail"){$$(".contact_info .view_contact_info").each(function(e){e.select(".contact_viewed_text")[0].update('<span class="already_contacted_image"></span>Contact Viewed On <b>'+contacted_date+"</b>")})}else{var vci_container=$$("."+lid+" .contact_info");vci_container=vci_container[0];if($(vci_container)!=undefined&&$(notification_container)!=undefined){vci_container.addClassName("v_indicator");notification_container.update('<span class="already_contacted_image"></span><span>Contact Viewed On <b>'+contacted_date+"</b></span>")}}}}}}else{if(view_type=="d-vert"){if(context=="sm"){$$("#h_send_message_container .msghtxtx").each(function(elem){elem.update('<h2><strong>Send Reminder</strong><span class="already_contacted_text"> Contacted on '+contacted_date+"</span></h2>")});$$("#h_send_message_container .msg_icon").each(function(elem){elem.addClassName("msg_icon_reminder")});$$("#h_send_message_container .sendmsgntn").each(function(e){e.value="Send Reminder"})}}else{if(view_type=="d-horz"){if(context=="sm"){$$("#v_send_message_container .mhright").each(function(elem){elem.update("<h2></span><div><strong>Send Reminder</strong></div>Contacted on <b>"+contacted_date+"</b></h2>")});$$("#v_send_message_container .mhicon").each(function(elem){elem.addClassName("mhicon_reminder")});$$("#v_send_message_container .sendmsgntn").each(function(e){e.value="Send Reminder"})}}}}},handleListingClick:function(listing_id){var container=$$("."+listing_id+" #listing_details_"+listing_id);container.each(function(elem){elem.addClassName("already_seen")})},fetchProjects:function(slider){var currentPage=1;var pageSize=this.projectSearchPageSize;var projects=$$("li.project_wid");var isFilterChanged=false;var lastPageReached=false;if(slider==undefined){slider=jQuery(".project_wid_flex").data("flexslider");isFilterChanged=true;if(typeof jQuery.cfitrack!=="undefined"){jQuery(".project_wid_flex .p-item-wrapper").cfitrack("destroy")}if(slider.slides.length<3||!($(slider.slides[slider.slides.length-1]).hasClassName("loading_slide"))||PropertySearchPage.lastPageReachedForProject==true){slider.addSlide("<li class='loading_slide'> </li>");slider.addSlide('<li class="loading_slide loading"> <img src="/cfassets/images/common/loader.gif" style="margin-top: 200px;margin-left:332px"></img></li>');slider.addSlide("<li class='loading_slide'> </li>")}for(count=0;count<projects.length;count++){slider.removeSlide(projects[count])}slider.moveToSlide(0);PropertySearchPage.lastPageReachedForProject=false}else{if(PropertySearchPage.lastPageReachedForProject==true){return}if(projects.length<3){slider.moveToSlide(0);PropertySearchPage.lastPageReachedForProject=true;return}currentPage=parseInt(projects.length/pageSize)+1}new Ajax.Request("/property/get-projects",{method:"POST",parameters:$("property_listing_input_options").serialize()+"&page="+currentPage+"&isAjax=1&page_size="+pageSize,onSuccess:function(transport){var totalProjects=$$("li.project_wid").length;var moveto=totalProjects;new_slide=document.createElement("div");new_slide.innerHTML=transport.responseText;var newSlides=new_slide.getElementsByTagName("li");var total_slides=newSlides.length;if(total_slides<6){PropertySearchPage.lastPageReachedForProject=true}else{PropertySearchPage.lastPageReachedForProject=false}var current_count=jQuery('#project_widget_slides .p-item-wrapper[cfi_entity_type="projects"]').length;for(var i=0;i<total_slides;i++){if(newSlides[0]!=undefined){var current_position=jQuery(newSlides[0]).find(".p-item-wrapper").attr("cfi_position");var updated_position=parseInt(current_position)+current_count;jQuery(newSlides[0]).find(".p-item-wrapper").attr("cfi_position",updated_position);slider.addSlide(newSlides[0],totalProjects);if(typeof jQuery.cfitrack!=="undefined"){jQuery('#project_widget_slides .p-item-wrapper[cfi_entity_type="projects"]').eq(updated_position-1).cfitrack({commonDataElement:jQuery("#cfi_listing_common_data"),parent:jQuery(".flexslider.project_wid_flex"),isPositionFixed:false})}}totalProjects++}var projects=$$("li.loading_slide");for(count=0;count<3;count++){slider.removeSlide(projects[count])}slider.update();if(isFilterChanged==true&&slider.slides<=0){$("project-bar").hide()}else{$("project-bar").show()}},onFailure:function(transport){}})},furnishState:function(){Effect.toggle("furnishState","blind",{duration:0})}};var debounce=function(func,threshold,execAsap,execAlways){var timeout;return function debounced(){var obj=this,args=arguments;function delayed(){if(!execAsap){func.apply(obj,args)}timeout=null}if(timeout){clearTimeout(timeout)}else{if(execAsap){func.apply(obj,args)}}timeout=setTimeout(delayed,threshold||100);execAlways&&execAlways.apply(obj,args)}};PropertySearchPage.filterEventHandler=debounce(PropertySearchPage.fetchResults,1000,false,function(){if(!($("requirement_request")!=undefined&&$("requirement_request").value==1)){$("listing_loader").show()}PropertySearchPage.filtersSetByUser=!0});var toTopPosition={trigger:0,topElem:null,refElem:null,size:null,top:0,maxOffset:0,init:function(){this.topElem=$("iscroll_to_top");this.refElem="iscroll";if($(this.refElem)){this.maxOffset=$(this.refElem).cumulativeOffset().top}this.topElem.hide();this.resize();this.scroll=this.scroll.bind(this);this.resize=this.resize.bind(this);Event.observe(window,"scroll",this.scroll);Event.observe(window,"resize",this.resize);this.handleTopButton=this.handleTopButton.bind(this);Event.observe($("results_div"),"inf:pageSuccess",this.handleTopButton);Event.observe($("results_div"),"inf:reset",this.handleTopButton);this.handleRelevantTopButton=this.handleRelevantTopButton.bind(this);if($("results_div1")!=undefined){Event.observe($("results_div1"),"inf:pageSuccess",this.handleRelevantTopButton);Event.observe($("results_div1"),"inf:reset",this.handleRelevantTopButton)}},destory:function(){Event.stopObserving(window,"scroll",this.scroll);Event.stopObserving(window,"resize",this.resize);Event.stopObserving($("results_div"),"inf:pageSuccess",this.handleTopButton);Event.stopObserving($("results_div"),"inf:reset",this.handleTopButton);if($("results_div1")!=undefined){Event.stopObserving($("results_div1"),"inf:pageSuccess",this.handleRelevantTopButton);Event.stopObserving($("results_div1"),"inf:reset",this.handleRelevantTopButton)}this.topElem.hide()},resize:function(){var prevElem=this.topElem.previous(0);var offset;if(prevElem){offset=prevElem.cumulativeOffset();this.topElem.setStyle({left:(offset.left+(prevElem.getWidth()-this.topElem.getWidth())/2)+"px"});this.trigger=(offset.top+prevElem.getHeight())}this.size=InfiniteContent.getDisplaySize();this.top=(this.size.height-this.topElem.getHeight());this.topElem.setStyle({top:this.top+"px"});if($(this.refElem)){this.maxOffset=$(this.refElem).cumulativeOffset().top}},handleRelevantTopButton:function(){this.refElem="other_iscroll";this.resize()},handleTopButton:function(){this.refElem="iscroll";this.resize()},scroll:function(){var d=this.getScrollPositions();if(d.scrollTop>=this.trigger){if(this.topElem.style.display=="none"||this.topElem.style.opacity){this.topElem.appear({duration:0.25})}if((d.scrollTop+this.top)>=this.maxOffset){if(this.topElem.style.position=="fixed"){var top=this.maxOffset;if(this.refElem=="other_iscroll"){top-=100}this.topElem.setStyle({top:top+"px",position:"absolute"})}}else{if(this.topElem.style.position=="absolute"){this.topElem.setStyle({top:this.top+"px",position:"fixed"})}}}else{if(this.topElem.style.display!="none"){this.topElem.fade()}}},getZoomFactor:function(){var factor=1;if(document.body.getBoundingClientRect){var rect=document.body.getBoundingClientRect();var physicalW=rect.right-rect.left;var logicalW=document.body.offsetWidth;factor=Math.round((physicalW/logicalW)*100)/100}return factor},getScrollPositions:function(){if("pageXOffset" in window){var scrollLeft=window.pageXOffset;var scrollTop=window.pageYOffset}else{var zoomFactor=this.getZoomFactor();var scrollLeft=Math.round(document.documentElement.scrollLeft/zoomFactor);var scrollTop=Math.round(document.documentElement.scrollTop/zoomFactor)}return{scrollTop:scrollTop,scrollLeft:scrollLeft}}};document.observe("dom:loaded",function(){PropertySearchPage.bindMinimize();try{$("results_div").observe("inf:pageSuccess",function(){PropertySearchPage.bindMinimize()});$("results_div1").observe("inf:pageSuccess",function(){PropertySearchPage.bindMinimize()})}catch(err){}});function handleMoreDetail(listing_id,index){var links=$("info_link_"+listing_id).childElements();var info=$("more_info_"+listing_id).childElements();if($(links[index]).hasClassName("activetab")){links[index].className="";info[index].removeClassName("displayblock")}else{for(var i=0;i<links.length;i++){links[i].className="";info[i].removeClassName("displayblock")}links[index].className="activetab";info[index].addClassName("displayblock")}}document.observe("dom:loaded",function(){addHoverStateForListings()});function addHoverStateForListings(){if($("property_listing_results_div")!=undefined){$("property_listing_results_div").observe("mouseover",function(e,el){if(el=e.findElement(".listing_snippet")){var displayTab=el.select(".more_information");displayTab[0].show()}});$("property_listing_results_div").observe("mouseout",function(e,el){if(el=e.findElement(".listing_snippet")){var displayTab=el;var more_info=el.select(".more_information");var more_infotab=el.select(".more_info_box .more_info");var checkOpenBox=0;for(var i=0;i<more_infotab.length;i++){if($(more_infotab[i]).hasClassName("displayblock")){checkOpenBox=1}}if(checkOpenBox==0){more_info[0].hide()}}})}}function PShowMoreContet(project_list_id){$("project_short_desc_"+project_list_id).hide();$("pshow_more_"+project_list_id).hide();$("pshow_less_"+project_list_id).show();$("project_long_desc_"+project_list_id).show()}function PShowlessContet(project_list_id){$("project_short_desc_"+project_list_id).show();$("pshow_more_"+project_list_id).show();$("pshow_less_"+project_list_id).hide();$("project_long_desc_"+project_list_id).hide()};